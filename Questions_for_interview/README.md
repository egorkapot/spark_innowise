<h1 align="center">Questions for interview</h1>


## Description

–ó–¥–µ—Å—å –±—É–¥—É—Ç –≤–æ–ø—Ä–æ—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É –≤–∞–º –ø–æ–ø–∞—Å—Ç—å—Å—è –Ω–∞ —Å–æ–±–µ—Å–µ.

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —á—Ç–æ–±—ã –≤–∞—à –≤–æ–ø—Ä–æ—Å –±—ã–ª –æ—Å–≤–µ—â–µ–Ω –∑–¥–µ—Å—å - –ø–∏—à–∏—Ç–µ –º–Ω–µ –≤ –ª–∏—á–∫—É –≤ —Ç–≥ @egorkapot –∏–ª–∏ –¥–µ–ª–∞–π—Ç–µ –º–µ—Ä–¥–∂ —Ä–µ–∫–≤–µ—Å—Ç

–ù–µ –∑–∞–±—É–¥—å—Ç–µ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –∑–≤–µ–∑–¥–æ—á–∫—É ‚≠ê —ç—Ç–æ–º—É –≥–∞–π–¥—É, —á—Ç–æ–±—ã –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å ü§©

# –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
1. –ß—Ç–æ —Ç–∞–∫–æ–µ Spark
2. –ß—Ç–æ —Ç–∞–∫–æ–µ Map Reduce –∏ –≤ —á—ë–º –µ–≥–æ —Å—É—Ç—å
3. –ö–∞–∫–∏–µ —ç—Ç–∞–ø—ã –µ—Å—Ç—å –≤ Map Reduce
4. –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É Spark –∏ Hadoop
5. RDD, DF, Dataset - —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –Ω–∏–º–∏(–≤ —Ä–∞–º–∫–∞—Ö PySpark —Ç–æ–ª—å–∫–æ RDD –∏ DF)
6. –ß—Ç–æ —Ç–∞–∫–æ–µ DAG –∏ –∫–∞–∫ —ç—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å–æ —Å–ø–∞—Ä–∫–æ–º
7. –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –¥–µ–π—Å—Ç–≤–∏—è–º–∏ –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è–º–∏
8. –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —É–∑–∫–∏–º–∏ –∏ —à–∏—Ä–æ–∫–∏–º–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è–º–∏
9. –ß—Ç–æ —Ç–∞–∫–æ–µ job, stage, task
10. –í–∏–¥—ã –¥–∂–æ–π–Ω–æ–≤(–Ω–µ –ª–µ—Ñ—Ç, —Ä–∞–π—Ç –∏ –∏–Ω–Ω–µ—Ä, –∞ –∏–º–µ–Ω–Ω–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –¥–∂–æ–π–Ω–∞ –≤ —Å–ø–∞—Ä–∫–µ)
11. –ö–æ–≥–¥–∞ –∫–∞–∫–æ–π –¥–∂–æ–π–Ω —é–∑–∞—Ç—å
12. –ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è –ø–∏—Å–∞—Ç—å –±–µ–∑–¥—É–º–Ω–æ collect –∏ –ø—Ä–æ—á–∏–µ —Ç–∞–∫–∏–µ —à—Ç—É–∫–∏
13. –ö–∞–∫ –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è —Ñ–∞–π–ª –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≤ Spark
14. –ö–∞–∫ –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–∂–∞—Ç—ã–π —Ñ–∞–π–ª –≤ Spark
15. –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É repartion –∏ coalesce
16. –ó–∞—á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å repartition
17. –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É Repartition –∏ Coalesce
18. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç partitionBy
19. PartitionBy –≤ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å repartition –∏–ª–∏ coalesce
20. –ö–∞–∫ —É–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ shuffle
21. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ—Ç–æ—Ä—ã–µ —é–∑–∞–µ—Ç –∫–∞—Ç–∞–ª–∏—Å—Ç
22. –ö–∞–∫ —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É Data Skew –∏ –≤–æ–æ–±—â–µ —á—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ
23. UDF –∏ –ø–æ—á–µ–º—É PySpark UDF —ç—Ç–æ –ø–ª–æ—Ö–æ. –ß–µ–º –∑–∞–º–µ–Ω–∏—Ç—å PySpark UDF
24. Delta Lake –∏ –ø–æ—á–µ–º—É –æ–Ω
25. –°—Ç—Ä–∏–º–∏–Ω–≥ –≤ Spark
26. –ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –ø–∞–º—è—Ç–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ JVM+overhead 
27. –ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –ø–∞–º—è—Ç–∏ –Ω–∞ –ø–æ–ª–Ω–æ–º —É—Ä–æ–≤–Ω–µ(–µ—Å–ª–∏ —ç—Ç–æ PySpark —Ç–æ —Ç–∞–º –Ω–µ —Ç–æ–∫ JVM –∏ overhead)
28. Parquet format 
29. –ù—é–∞–Ω—Å—ã –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ JSON 
30. –ù—é–∞–Ω—Å—ã –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ CSV 
31. Broadcast variables

# Questions

## –ß—Ç–æ —Ç–∞–∫–æ–µ Spark

BigData —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º, –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –ø–∞–∫–µ—Ç–Ω–æ–π –∏ –ø–æ—Ç–æ–∫–æ–≤–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏ —Å–ª–∞–±–æ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –≤—Ö–æ–¥—è—â–∏–π –≤ —ç–∫–æ—Å–∏—Å—Ç–µ–º—É Hadoop. 

–í —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ —Å–∏—Å—Ç–µ–º –ª–µ–∂–∏—Ç 6 –ø–æ–Ω—è—Ç–∏–π: 

-   Cluster ‚Äì –≤—Å–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ (–∫–æ–º–ø—å—é—Ç–µ—Ä—ã –∏–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞), –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è **–Ω–æ–¥–∞–º–∏**. –ö–∞–∂–¥–∞—è –Ω–æ–¥–∞ –∏–º–µ–µ—Ç —Å–≤–æ–µ –∂–µ–ª–µ–∑–æ –∏ –û–°. –ù–æ–¥–∞–º–∏ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ —É–ø—Ä–∞–≤–ª—è–µ—Ç **cluster manager**. 

-   Worker - –ù–æ–¥–∞ –∏–ª–∏ —Å–µ—Ç—å –Ω–æ–¥ —Ä–µ—Å—É—Ä—Å—ã –∫–æ—Ç–æ—Ä—ã—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–ø–∞—Ä–∫–∞.  

-   Executor - –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–Ω—è—â–∏–π—Å—è –≤ JVM. –ù–∞ –∫–∞–∂–¥–æ–º –≤–æ—Ä–∫–µ—Ä–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ **executors**. –ò–º–µ–Ω–Ω–æ **executor** –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–∞–±–æ—Ç—É –∏ –ø—Ä–æ—Ü–µ—Å—Å—ã –∏—Å–ø–æ–ª—å–∑—É—è –∂–µ–ª–µ–∑–æ –≤–æ—Ä–∫–µ—Ä–∞. 

-   Master - –º–∞—à–∏–Ω–∞ –æ—Ç–∫—É–¥–∞ –ø–∏—à–µ—Ç—Å—è –∫–æ–¥ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ. –ü–æ —Å—É—Ç–∏ —Ç–∞–º –≥–¥–µ –≤—ã –ø–∏—à–µ—Ç–µ –∫–æ–¥ 

-   Driver - –ü—Ä–æ—Ü–µ—Å—Å –∫–æ—Ç–æ—Ä—ã–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–∞–ø—É—Å–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–∞–∫ –Ω–∞ –º–∞—Å—Ç–µ—Ä–µ —Ç–∞–∫ –∏ –Ω–∞ –Ω–æ–¥–µ. –í –¥—Ä–∞–π–≤–µ—Ä–µ –µ—Å—Ç—å –º–µ—Ç–æ–¥ **main()** –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç **Spark-session** —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –ª–æ–≥–∏—á–µ—Å–∫–∏–º —Ü–µ–Ω—Ç—Ä–æ–º —Å–ø–∞—Ä–∫–∞ –∏ –¥–µ–ª–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –≤–µ—â–∏: 

    -   –ù–∞—Ä–µ–∑–∞–µ—Ç –∫–æ–¥ –Ω–∞ **job, stage, task**

    -   –°–æ–∑–¥–∞–µ—Ç **Logical & Physical Plan** 

    -   –ö–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç **cluster manager** –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–¥–∞—á –Ω–∞ **executors** 

    -   –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å –µ–≥–æ —ç—Ç–∞–ø–∞–º–∏ 

-   Cluster Manager - –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ **–≤—ã–¥–µ–ª—è–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã**. –ö–æ–≥–¥–∞ –º—ã –∑–∞–ø—É—Å–∫–∞–µ–º –∫–æ–¥ —Ç–æ –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è **driver**, –∫–æ—Ç–æ—Ä—ã–π –≥–æ–≤–æ—Ä–∏—Ç —Å–∫–æ–ª—å–∫–æ –Ω—É–∂–Ω–æ executors —Å –∫–∞–∫–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –∏ –≥–æ–≤–æ—Ä–∏—Ç –æ–± —ç—Ç–æ–º cluster manager. –ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∏–¥–æ–≤ Cluster Manager: 

    -   Spark Standalone Cluster Manager. –°–∞–º—ã–π –æ–±—ã—á–Ω—ã–π –∏ –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å —Å–∞–º–∏–º —Å–ø–∞—Ä–∫–æ–º. –ù–µ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)) 

    -   Apache Mesos. –ß—É—Ç—å —Å–ª–æ–∂–Ω–µ–µ –∏ –∫—Ä—É—á–µ, –Ω–æ –µ—Å–ª–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ü–µ–ª—è—Ö, —Ç–æ —ç—Ç–æ—Ç —è –≤–æ–æ–±—â–µ –Ω–µ –≤–∏–¥–µ–ª —á—Ç–æ–±—ã —é–∑–∞–ª—Å—è. 

    -   Hadoop YARN. –î–æ –ø—Ä–∏—Ö–æ–¥–∞ –Ω–∞ —Ä—ã–Ω–æ–∫ k8s –±—ã–ª –æ–¥–Ω–∏–º –∏–∑ –ª—É—á—à–∏—Ö —Ä–µ—à–µ–Ω–∏–π, –æ–¥–Ω–∞–∫–æ –∏–∑-–∑–∞ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å–µ–π—á–∞—Å —é–∑–∞–µ—Ç—Å—è —Ä–µ–∂–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä –≤ –æ–±–ª–∞—á–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏—è—Ö(—Ç–æ—Ç –∂–µ AWS EMR). 

    -   k8s. –°–∞–º—ã–π –ª—É—á—à–∏–π –∏ —á–∞—â–µ –≤—Å–µ–≥–æ –±—É–¥–µ—Ç –æ–Ω. –û–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ k8s –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ, —è –ª–∏—à—å —Å–∫–∞–∂—É —á—Ç–æ –≤ —Ä–∞–º–∫–∞—Ö —Å–ø–∞—Ä–∫–∞ –æ–¥–∏–Ω executor=–æ–¥–∏–Ω pod. –≠—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –≥–∏–±–∫–æ—Å—Ç—å. 

 
## –ß—Ç–æ —Ç–∞–∫–æ–µ Map Reduce –∏ –≤ —á—ë–º –µ–≥–æ —Å—É—Ç—å

–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö. –ü—Ä–æ–≥—Ä–∞–º–º—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞—é—Ç—Å—è –∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –Ω–æ–¥–∞—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞, –ø—Ä–∏ —ç—Ç–æ–º –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–∞–º–∞ –∑–∞–±–æ—Ç–∏—Ç—Å—è –æ –¥–µ—Ç–∞–ª—è—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏. –ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –º–Ω–æ–≥–æ –¥–ª—è —á–µ–≥–æ: –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –≤–µ–± –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –∏—Ç–¥. –ó–∞ –æ—Å–Ω–æ–≤—É –≤–∑—è—Ç—ã –¥–≤–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã **map** - –ø—Ä–∏–º–µ–Ω—è–µ—Ç –Ω—É–∂–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –∫ –∫–∞–∂–¥–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É —Å–ø–∏—Å–∫–∞ –∏ **reduce** - –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã map. 


## –ö–∞–∫–∏–µ —ç—Ç–∞–ø—ã –µ—Å—Ç—å –≤ Map Reduce

-   Map ‚Äì –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –≤–∏–¥–µ –±–æ–ª—å—à–æ–≥–æ **—Å–ø–∏—Å–∫–∞** –∑–Ω–∞—á–µ–Ω–∏–π. –ü—Ä–∏ —ç—Ç–æ–º –≥–ª–∞–≤–Ω—ã–π —É–∑–µ–ª –∫–ª–∞—Å—Ç–µ—Ä–∞ (master node) –ø–æ–ª—É—á–∞–µ—Ç —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫, **–¥–µ–ª–∏—Ç** –µ–≥–æ **–Ω–∞ —á–∞—Å—Ç–∏** –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç —Ä–∞–±–æ—á–∏–º —É–∑–ª–∞–º (worker node). –î–∞–ª–µ–µ **–∫–∞–∂–¥—ã–π** —Ä–∞–±–æ—á–∏–π **—É–∑–µ–ª** –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é **Map** –∫ –ª–æ–∫–∞–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ ¬´**–∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ**¬ª –≤–æ **–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ**. 

-   Combine - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–Ω–∏—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–π –Ω–æ–¥–µ **–æ—Ç–¥–µ–ª—å–Ω–æ**. –ü–æ —Å—É—Ç–∏ —ç—Ç–æ —Ç–æ—Ç –∂–µ —Ä–µ–¥—å—é—Å –¥–æ —à–∞—Ñ–ª–∞ –∫–æ—Ç–æ—Ä—ã–π —É–º–µ–Ω—å—à–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∑–∞–∫–∏–Ω—É—Ç—ã –≤ —à–∞—Ñ–ª 

-   Shuffle - –∫–æ–≥–¥–∞ —Ä–∞–±–æ—á–∏–µ —É–∑–ª—ã **–ø–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç** –¥–∞–Ω–Ω—ã–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ **–∫–ª—é—á–µ–π**, —Ä–∞–Ω–µ–µ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–µ–π Map, —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –≤—Å–µ **–¥–∞–Ω–Ω—ã–µ** –æ–¥–Ω–æ–≥–æ **–∫–ª—é—á–∞** –ª–µ–∂–∞–ª–∏ –Ω–∞ **–æ–¥–Ω–æ–º** —Ä–∞–±–æ—á–µ–º **—É–∑–ª–µ**. 

-   Reduce ‚Äì –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è **–æ–±—Ä–∞–±–æ—Ç–∫–∞** –∫–∞–∂–¥—ã–º —Ä–∞–±–æ—á–∏–º —É–∑–ª–æ–º –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã –¥–∞–Ω–Ω—ã—Ö –ø–æ –ø–æ—Ä—è–¥–∫—É —Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∫–ª—é—á–µ–π –∏ ¬´**—Å–∫–ª–µ–π–∫–∞**¬ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–∞ **master node**. –ì–ª–∞–≤–Ω—ã–π —É–∑–µ–ª –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –æ—Ç —Ä–∞–±–æ—á–∏—Ö —É–∑–ª–æ–≤ –∏ –ø–µ—Ä–µ–¥–∞—ë—Ç –∏—Ö –Ω–∞ —Å–≤–æ–±–æ–¥–Ω—ã–µ —É–∑–ª—ã –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞. –ü–æ–ª—É—á–∏–≤—à–∏–π—Å—è –ø–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —à–∞–≥–æ–≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Äì —ç—Ç–æ –∏ –µ—Å—Ç—å —Ä–µ—à–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–π –∑–∞–¥–∞—á–∏. 


## –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É Spark –∏ Hadoop

–•–∞–¥—É–ø–æ–≤—Å–∫–∏–π MapReduce –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ –±–∞–∑–µ **–¥–∏—Å–∫–æ–≤–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞**, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ —Å–ø–∞—Ä–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–∏—Ç–∏–≤—ã –¥–ª—è —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤ **–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏**. –ó–∞ —Å—á–µ—Ç —ç—Ç–æ–≥–æ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ —Ä–µ–∞–ª–∏–∑—É—é—Ç—Å—è –Ω–∞ —Å–ø–∞—Ä–∫–µ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ **–±—ã—Å—Ç—Ä–µ–µ**. 

<p align="center">
<img src="/../main/Questions_for_interview/Images/hadoopvsspark.png" width="80%"></p>

## RDD, DF, Dataset - —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –Ω–∏–º–∏(–≤ —Ä–∞–º–∫–∞—Ö PySpark —Ç–æ–ª—å–∫–æ RDD –∏ DF)

RDD - —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Spark –º–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å low-level API. –°—Ç–æ–∏—Ç –∑–∞–ø–æ–º–Ω–∏—Ç—å —á—Ç–æ RDD:

    -   –ù–µ–∏–∑–º–µ–Ω—è–µ–º
    -   –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω (–º–Ω–æ–≥–æ –ø–∞—Ä—Ç–∏—Ü–∏–π)
    -   –ü–∞—Ä—Ç–∏—Ü–∏–∏ RDD –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
    -   Fault-tolerant (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –Ω–æ–¥—ã)


Dataframe –∏ Dataset –±—ã–ª–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ –º–µ—Ö–∞–Ω–∏–∑–º–µ RDD –∏ –ø–æ–ª—É—á–∏–ª–∏ –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞–ø—Ä–∏–º–µ—Ä:

    -   –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º–∞–º–∏
    -   –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

Dataframes –∏–º–µ—é—Ç —Å—Ö–æ–∂–∏–π API —Å RDD —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –¥–ª—è big data processing –Ω–∞–ø—Ä–∏–º–µ—Ä **filtering**, **aggregation** etc. 

RDD —É–¥–æ–±–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—è –∏ –≥–∏–±–∫–æ—Å—Ç–∏ –Ω–∞–¥ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏. Dataframes –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∏–ª–∏ —Å–ª–∞–±–æ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏ –∫–æ–≥–¥–∞ –º—ã —Ö–æ—Ç–∏–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –æ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ Catalyst (–ø—Ä–æ –Ω–µ–≥–æ –ø–æ–∑–∂–µ). –í —Ü–µ–ª–æ–º –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Dataframes –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –¥–∞—é—Ç –ø–ª—é—Å –≤ –ø—Ä–æ–∏–∑–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. RDD –º–æ–∂–Ω–æ —é–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ –≥–∏–±–∫–æ—Å—Ç—å –∏ –º—ã —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –Ω–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–µ–º—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤—Ä–æ–¥–µ txt



## –ß—Ç–æ —Ç–∞–∫–æ–µ DAG –∏ –∫–∞–∫ —ç—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å–æ —Å–ø–∞—Ä–∫–æ–º

DAG (–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –ê—Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–π –ì—Ä–∞—Ñ) –≤ —Å–ø–∞—Ä–∫–µ - —ç—Ç–æ —à—Ç—É–∫–∞ –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—É—Ç—å RDD –æ—Ç –Ω–∞—á–∞–ª–∞ –¥–æ –∫–æ–Ω—Ü–∞ –∏ –∫–∞–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –Ω–∏–º–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç. 

## –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –¥–µ–π—Å—Ç–≤–∏—è–º–∏ –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è–º–∏

–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤—ã–π Dataset, DataFrame, RDD. –ï—Å–ª–∏ —ç—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —á—Ç–æ —Ç–æ –¥—Ä—É–≥–æ–µ –∏–ª–∏ –≤–æ–æ–±—â–µ –Ω–∏—á–µ–≥–æ - —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ 

–ö—Ä–æ–º–µ —Ç–æ–≥–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è - —ç—Ç–æ **–ª–µ–Ω–∏–≤–∞—è** —à—Ç—É–∫–∞ –∫–æ—Ç–æ—Ä–∞—è **–Ω–µ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é**. –°–ø–∞—Ä–∫ –ø—Ä–æ—Å—Ç–æ –∑–∞–ø–æ–º–Ω–∏—Ç —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, –∞ **–¥–µ–π—Å—Ç–≤–∏–µ** –∫–∞–∫ —Ä–∞–∑ **–∑–∞–ø—É—Å–∫–∞–µ—Ç** —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é. 

## –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —É–∑–∫–∏–º–∏ –∏ —à–∏—Ä–æ–∫–∏–º–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è–º–∏

### –£–∑–∫–∏–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ 

–£–∑–∫–∏–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –≤ —Ä–∞–º–∫–∞—Ö –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ä—Ç–∏—à–Ω–∞ –Ω–µ –∫–∞—Å–∞—è—Å—å –¥—Ä—É–≥–∏—Ö. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Ö–æ–¥—è—â–∏—Ö –ø–∞—Ä—Ç–∏—à–Ω–æ–≤ = –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∏—Å—Ö–æ–¥—è—â–∏—Ö.  

-   –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ —Ç–∞–∫–∏–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –±—ã—Å—Ç—Ä—ã–µ. 

-   –ù–µ –≤—ã–∑—ã–≤–∞—é—Ç —à–∞—Ñ–ª–∞ = –Ω–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø–æ —Å—Ç–µ–π–¥–∂–∞–º 

-   Map() & filter() - –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ —É–∑–∫–∏–º —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è–º 

<p align="center">
<img src="/../main/Questions_for_interview/Images/narrow-transformation.png" width="80%"></p>

### –®–∏—Ä–æ–∫–∏–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏

–≠—Ç–æ—Ç —Ç–∏–ø –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –±—É–¥–µ—Ç –∏–º–µ—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä—Ç–∏—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –æ—Ç–Ω–æ—Å–∏—Ç—å—Å—è –∫–æ –º–Ω–æ–≥–∏–º –≤—ã—Ö–æ–¥–Ω—ã–º –ø–∞—Ä—Ç–∏—Ü–∏—è–º. –ö–∞–∂–¥—ã–π –ø–∞—Ä—Ç–∏—à–Ω –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º RDD –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ä–∞–∑–Ω—ã–º–∏ –ø–∞—Ä—Ç–∏—à–Ω–∞–º–∏ –≤ –¥–æ—á–µ—Ä–Ω–µ–º RDD. –í—Å–µ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç **—à–∞—Ñ–ª –¥–∞–Ω–Ω—ã—Ö**.

-   –ú–µ–¥–ª–µ–Ω–Ω—ã–µ, —Å–∫–æ—Ä–æ—Å—Ç—å –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π. –ö–∞–∫ –±—ã–ª–æ —Å–∫–∞–∑–∞–Ω–æ –≤—ã—à–µ - –≤—ã–∑—ã–≤–∞–µ—Ç —à–∞—Ñ–ª –¥–∞–Ω–Ω—ã—Ö. 

-   GroupByKey(), aggregateByKey(), aggregate(), join(), repartition() - –ø—Ä–∏–º–µ—Ä—ã —Ñ—É–Ω–∫—Ü–∏–π 

<p align="center">
<img src="/../main/Questions_for_interview/Images/wide-transformation.png" width="80%"></p>

## –ß—Ç–æ —Ç–∞–∫–æ–µ job, stage, task

-   –¢–∞—Å–∫ - –≤—ã–ø–æ–ª–Ω—è—é—â–∞—è—Å—è –∑–∞–¥–∞—á–∞ –≤ —Å–ø–∞—Ä–∫–µ –∫–æ—Ç–æ—Ä–∞—è —Ö—Ä–∞–Ω–∏—Ç –≤ —Å–µ–±–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —á—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏—Ç–¥). –ù—É–∂–Ω–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å —á—Ç–æ **–æ–¥–Ω–∞ —Ç–∞—Å–∫–∞ - –æ–¥–Ω–∞ –ø–∞—Ä—Ç–∏—Ü–∏—è** 

-   Stage - –∫–∞–∂–¥–∞—è —Å—Ç–µ–π–¥–∂–∞ —Ö—Ä–∞–Ω–∏—Ç –≤ —Å–µ–±–µ —Ç–∞—Å–∫–∏ –∏ –∫–∞–∂–¥–∞—è —Ç–∞—Å–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Å–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π. –ü—Ä–∏–∫–æ–ª –≤ —Ç–æ–º —á—Ç–æ **–ø—Ä–∏ —à–∞—Ñ–ª–µ** —É—Å–ª–æ–≤–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –º–µ–∂–¥—É —Å—Ç–µ–π–¥–∂–∞–º–∏ - **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ**.  

-   Job - –ø—Ä–æ—Å—Ç–æ —Ö—Ä–∞–Ω–∏—Ç –≤ —Å–µ–±–µ —Å—Ç–µ–π–¥–∂–∏. –ù–æ–≤–∞—è –¥–∂–æ–±–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è –∫–∞–∫ **write()**. –ò –¥–∂–æ–±–∞ –∫–∞–∫ —Ä–∞–∑ –∏ —è–≤–ª—è–µ—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏–µ–º, –∫–æ—Ç–æ—Ä–æ–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ = –≤–∞—Ä–∏–∞—Ü–∏–∏ –≤—Å–µ—Ö —Å—Ç–µ–π–¥–∂–µ–π –∏ –∏—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π. 

-   Application - —Ö—Ä–∞–Ω–∏—Ç –≤ —Å–µ–±–µ –¥–∂–æ–±—ã 


## –í–∏–¥—ã –¥–∂–æ–π–Ω–æ–≤(–Ω–µ –ª–µ—Ñ—Ç, —Ä–∞–π—Ç –∏ –∏–Ω–Ω–µ—Ä, –∞ –∏–º–µ–Ω–Ω–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –¥–∂–æ–π–Ω–∞ –≤ —Å–ø–∞—Ä–∫–µ)

–í —Å–ø–∞—Ä–∫–µ –µ—Å—Ç—å 5 –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –¥–∂–æ–π–Ω–æ–≤: 

-   –ü–µ—Ä–µ–º–µ—à–∞–Ω–Ω—ã–π —Ö–µ—à (Shuffle Hash Join) 

-   –®–∏—Ä–æ–∫–æ–≤–µ—â–∞—Ç–µ–ª—å–Ω—ã–π —Ö–µ—à (Broadcast Hash Join) 

-   –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑ —Å–ª–∏—è–Ω–∏–µ (Sort Merge Join) 

-   –î–µ–∫–∞—Ä—Ç–æ–≤ –¥–∂–æ–π–Ω (Cartesian Join) 

-   –®–∏—Ä–æ–∫–æ–≤–µ—â–∞—Ç–µ–ª—å–Ω—ã–π –¥–∂–æ–π–Ω –≤–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ (Broadcast Nested Loop Join) 

### Broadcast Hash Join 

**–û–¥–∏–Ω** –∏–∑ –¥–≤—É—Ö –≤—Ö–æ–¥–Ω—ã—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö **—Ç—Ä–∞–Ω—Å–ª–∏—Ä—É–µ—Ç—Å—è –≤—Å–µ–º –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è–º**. **–•–µ—à-—Ç–∞–±–ª–∏—Ü–∞** —Å—Ç—Ä–æ–∏—Ç—Å—è –¥–ª—è **–≤—Å–µ—Ö –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –∏–∑ —Ç—Ä–∞–Ω—Å–ª–∏—Ä—É–µ–º–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö**. –ó–∞—Ç–µ–º **–∫–∞–∂–¥—ã–π** –ø–∞—Ä—Ç–∏—à–Ω **–Ω–µ —Ç—Ä–∞–Ω—Å–ª–∏—Ä—É–µ–º–æ–≥–æ –Ω–∞–±–æ—Ä–∞** –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –∫ –¥—Ä—É–≥–æ–º—É –Ω–∞–±–æ—Ä—É –¥–∞–Ω–Ω—ã—Ö. –û–Ω **–Ω–µ —Ç—Ä–µ–±—É–µ—Ç** —ç—Ç–∞–ø–∞ **–ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏—è**. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ **—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ** - —ç—Ç–æ —á—Ç–æ–±—ã –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ –∏–º–µ–ª–∏ **–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞–º—è—Ç–∏** –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è —Ç—Ä–∞–Ω—Å–ª–∏—Ä—É–µ–º–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö. –ü–æ—ç—Ç–æ–º—É –ª—É—á—à–µ –∏–∑–±–µ–≥–∞—Ç—å —Ç–∞–∫–æ–≥–æ –¥–∂–æ–π–Ω–∞ –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –±–æ–ª—å—à–∏–µ. 

### Shuffle Hash Join 

–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ **–≤—ã—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç** –æ–±–∞ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å–æ —Å—Ö–µ–º–æ–π —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è. –ï—Å–ª–∏ –æ–¥–∏–Ω –∏–ª–∏ –æ–±–∞ –Ω–∞–±–æ—Ä–∞ **–Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Å—Ö–µ–º–µ** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **—à–∞—Ñ–ª** –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –¥–∂–æ–π–Ω–∞. –ü–æ—Å–ª–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ö–µ—à –¥–∂–æ–π–Ω –∏–∑ –ø—Ä–∏–º–µ—Ä–∞ –≤—ã—à–µ. **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–∞–º—è—Ç–∏** –≤ —ç—Ç–æ–º –ø–æ–¥—Ö–æ–¥–µ **–º–µ–Ω—å—à–µ** —á–µ–º –≤ Broadcast Hash Join. –≠—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º —Ç—á–æ —Ç—É—Ç —Ö–µ—à —Ç–∞–±–ª–∏—Ü–∞ —Å—Ç—Ä–æ–∏—Ç—Å—è –Ω–∞ –º–µ–Ω—å—à–µ–º –Ω–∞–±–æ—Ä–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–∏ —ç—Ç–æ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –±—É–¥–µ—Ç –Ω–∏–∂–µ, –µ—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å —à–∞—Ñ–ª –¥–ª—è –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –æ–±–æ–∏—Ö –≤—Ö–æ–¥–Ω—ã—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö 

### Sort Merge Join 

–ö–∞–∫ –∏ –≤ —à–∞—Ñ–ª–µ –æ–±–∞ –Ω–∞–±–æ—Ä–∞ **–≤—ã—Ä–∞–≤–Ω–∏–≤–∞—é—Ç—Å—è** –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å–æ —Å—Ö–µ–º–æ–π –∏ –≤ —Å–ª—É—á–∞–µ **–Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è** - **—à–∞—Ñ–ª—è—Ç—Å—è**. –ü–æ—Å–ª–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥ Sort Merge Join. –û–Ω **–º–µ–Ω–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω —á–µ–º —Ö–µ—à–∏—Ä—É—é—â–∏–µ –¥–∂–æ–π–Ω—ã**, –Ω–æ –≥–æ—Ä–∞–∑–¥–æ **–Ω–∏–∂–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è** –ø–æ **–ø–∞–º—è—Ç–∏**. –ö–∞–∫ –∏ –≤ —à–∞—Ñ–ª—è—â–µ–º - –ø—Ä–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏—è –±–æ–ª—å—à–µ –≥—Ä—É–∑–∏—Ç—Å—è –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ. 

### Cartesian Join 

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–∫—Ä–µ—Å—Ç–Ω–æ–≥–æ –¥–∂–æ–π–Ω–∞** (–¥–µ–∫–∞—Ä—Ç–æ–≤–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ) –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–æ–¥–∏—Ç –≤—Å–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∫–æ—Ç–æ—Ä—ã–µ  –≤–æ–∑–º–æ–∂–Ω—ã –ø—Ä–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–∏ –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏ –∏–∑ –æ–¥–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å—å—é –∏–∑ –¥—Ä—É–≥–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –°–∏–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã—Ö–æ–¥–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–æ–≤.  

### Broadcast Nested Loop Join 

–û–¥–∏–Ω –∏–∑ –Ω–∞–±–æ—Ä–æ–≤ —Ç—Ä–∞–Ω—Å–ª–∏—Ä—É–µ—Ç—Å—è –≤—Å–µ–º –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è–º. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∫–∞–∂–¥—ã–π —Ä–∞–∑–¥–µ–ª –Ω–µ —Ç—Ä–∞–Ω—Å–ª–∏—Ä—É–µ–º–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∂–æ–π–Ω–∏—Ç—Å—è –∫ —Ç—Ä–∞–Ω—Å–ª–∏—Ä—É–µ–º–æ–º—É —Å –ø–æ–º–æ—â—å—é —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –ø—Ä–æ—Ü–µ–¥—É—Ä—ã. **–ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω** —Ç–∞–∫ –∫–∞–∫ —Ç—Ä–µ–±—É–µ—Ç **–≤—ã—á–∏—Å–ª–µ–Ω–∏–π —Ü–∏–∫–ª–æ–º** + —Ç—Ä–µ–±—É–µ—Ç **–º–Ω–æ–≥–æ –ø–∞–º—è—Ç–∏** –¥–ª—è —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–∏. 

## –ö–æ–≥–¥–∞ –∫–∞–∫–æ–π –¥–∂–æ–π–Ω —é–∑–∞—Ç—å

–í–æ–æ–±—â–µ –µ—Å—Ç—å —Ç–∞–∫–∞—è —à—Ç—É–∫–∞ –∫–∞–∫ AQE –∫–æ—Ç–æ—Ä–∞—è —Å–∞–º–∞ —Ä–µ—à–∞–µ—Ç –∫–æ–≥–¥–∞ –∫–∞–∫–æ–π –¥–∂–æ–π–Ω –ø—Ä–∏–º–µ–Ω–∏—Ç—å 

Spark –≤—ã–±–∏—Ä–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏ Join, –æ—Å–Ω–æ–≤—ã–≤–∞—è—Å—å –Ω–∞ —Å–ª–µ–¥—É—é—â–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–∞—Ö: 

-   –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ 

-   –ü–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è Join (–º–æ–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —Å—Ç–∞–≤–∏—Ç—å —Ö–∏–Ω—Ç—ã)

-   –†–∞–∑–º–µ—Ä –Ω–∞–±–æ—Ä–æ–≤ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö 

-   –¢–∏–ø Join 

-   –≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω—ã–µ –∏–ª–∏ –Ω–µ—ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω—ã–µ –¥–∂–æ–π–Ω—ã (Equi or Non-Equi Join) 

## –ü–æ—á–µ–º—É –Ω–µ–ª—å–∑—è –ø–∏—Å–∞—Ç—å –±–µ–∑–¥—É–º–Ω–æ collect –∏ –ø—Ä–æ—á–∏–µ —Ç–∞–∫–∏–µ —à—Ç—É–∫–∏

–ö–æ–ª–ª–µ–∫—Ç —Å–æ–±–∏—Ä–∞–µ—Ç **–¥–∞–Ω–Ω—ã–µ** —Å–æ **–≤—Å–µ—Ö RDD** —Å–æ **–≤—Å–µ—Ö –Ω–æ–¥** –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞ **–¥—Ä–∞–π–≤–µ—Ä**. –≠—Ç–æ –Ω–æ—Ä–º –ø—Ä–∏–º–µ–Ω—è—Ç—å –µ–≥–æ –Ω–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö, –Ω–æ –µ—Å–ª–∏ —é–∑–∞—Ç—å –µ–≥–æ –Ω–∞ –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö —Ç–æ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –ø–æ–ª—É—á–∏—à—å **OOM**. 

## –ö–∞–∫ –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è —Ñ–∞–π–ª –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≤ Spark

–ö–æ–≥–¥–∞ –º—ã —á–∏—Ç–∞–µ–º —Ñ–∞–π–ª –≤ RDD/Dataframe –≤ Spark –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø–æ –Ω–æ–¥–∞–º –∫–ª–∞—Å—Ç–µ—Ä–∞. –í–æ–æ–±—â–µ –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä—Ç–∏—Ü–∏–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Spark –∫–ª–∞—Å—Ç–µ—Ä–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º ```spark.default.parallelism``` –≤ —Ñ–∞–π–ª–µ ```conf/spark-defaults.conf``` –∏ —è–≤–ª—è–µ—Ç—Å—è **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —è–¥–µ—Ä** –≤ –∫–∞–∂–¥–æ–º –≤–æ—Ä–∫–µ—Ä–µ. –ü–æ—ç—Ç–æ–º—É –∫–æ–≥–¥–∞ –º—ã –≥—Ä—É–∑–∏–º —Ñ–∞–π–ª –≤ —Å–ø–∞—Ä–∫ –∏ –∑–Ω–∞—á–µ–Ω–∏–µ ```spark.default.parallelism``` –Ω–µ –∏–∑–º–µ–Ω—è–ª–æ—Å—å, —Ç–æ Spark —Å–æ–∑–¥–∞—Å—Ç —Å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–∞—Ä—Ç–∏—Ü–∏–π —Ä–∞–≤–Ω–æ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —è–¥–µ—Ä –¥—Ä–∞–π–≤–µ—Ä–∞(=–æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —è–¥–µ—Ä –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ).

–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –µ—â–µ —Å—Ç–æ–∏—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä—Ç–∏—Ü–∏–π –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –±–æ–ª—å—à–æ–≥–æ —Ñ–∞–π–ª–∞ —Ç–∞–∫ –∫–∞–∫ —Å–∏—Å—Ç–µ–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä HDFS) —Ö—Ä–∞–Ω—è—Ç –¥–∞–Ω–Ω—ã–µ –≤ –±–ª–æ–∫–∞—Ö —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–∞–º—è—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä 128MB). –ü–æ—ç—Ç–æ–º—É –∫–æ–≥–¥–∞ –º—ã —á–∏—Ç–∞–µ–º —Ñ–∞–π–ª 100TB –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–∑–±–∏—Ç –Ω–∞ –±–ª–æ–∫–∏ –ø–æ 128MB, —Ç–æ –º—ã –ø–æ–ª—É—á–∏–º –æ–∫–æ–ª–æ 819 200 –ø–∞—Ä—Ç–∏—Ü–∏–π.

–ï—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º —É–∫–∞–∑–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä—Ç–∏—Ü–∏–π —Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ```repartition()```, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```
# Read a large CSV file and repartition it into 200 partitions
df = spark.read.csv("/path/to/data.csv").repartition(200)
```

–≠—Ç–æ —Ä–∞–∑–¥–µ–ª–∏—Ç —Ñ–∞–π–ª –Ω–∞ 200 –ø–∞—Ä—Ç–∏—Ü–∏–π –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –ø–æ –Ω–æ–¥–∞–º.

## –ö–∞–∫ –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–∂–∞—Ç—ã–π —Ñ–∞–π–ª –≤ Spark

–ö–æ–≥–¥–∞ –º—ã —á–∏—Ç–∞–µ–º —Å–∂–∞—Ç—ã–π —Ñ–∞–π–ª –≤ Spark, –æ–Ω –Ω–∞—á–∏–Ω–∞–µ—Ç —á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª —á–∞–Ω–∫–∞–º–∏ –∏ –∫–∞–∂–¥—ã–π —á–∞–Ω–∫ –¥–µ–ª–∏—Ç –Ω–∞ –ø–∞—Ä—Ç–∏—Ü–∏–∏. –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ```repartition()``` –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–∞—Ä—Ç–∏—Ü–∏–π –ø—Ä–∏ –ø—Ä–æ—á–∏—Ç–µ–Ω–∏–∏ —Å–∂–∞—Ç–æ–≥–æ —Ñ–∞–π–ª–∞. –ù–∞–ø—Ä–∏–º–µ—Ä:
```
# Read a compressed CSV file and repartition it into 8 partitions
df = spark.read.format("csv").option("inferSchema", "true").option("header", "true").option("codec", "gzip").load("/path/to/data.csv.gz").repartition(8)
```
–≠—Ç–æ —Ä–∞–∑–¥–µ–ª–∏—Ç —Å–∂–∞—Ç—ã–π CSV –Ω–∞ 8 –ø–∞—Ä—Ç–∏—Ü–∏–π –∏—Å–ø–æ–ª—å–∑—É—è –¥–µ—Ñ–æ–ª—Ç–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è Spark (hash partitioning). –í—ã —Å–∞–º–∏ –º–æ–∂–µ—Ç–µ —É–∫–∞–∑–∞—Ç—å –¥—Ä—É–≥—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.

## –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É repartion –∏ coalesce 

–°–µ–π—á–∞—Å –±—É–¥–µ—Ç –∑–∞—Ç—Ä–æ–Ω—É—Ç–∞ —Ç–µ–º–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏ –∑–∞—á–µ–º –≤–æ–æ–±—â–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **repartition**. –ï–µ –º–æ–∂–Ω–æ –æ–ø—É—Å—Ç–∏—Ç—å –∏ –ø–µ—Ä–µ–π—Ç–∏ —Å—Ä–∞–∑—É –∫ [–æ—Ç–≤–µ—Ç—É –Ω–∞ –≤–æ–ø—Ä–æ—Å](https://github.com/egorkapot/Innowise_Spark_task/tree/main/Questions_for_interview#%D1%80%D0%B0%D0%B7%D0%BD%D0%B8%D1%86%D0%B0-%D0%BC%D0%B5%D0%B6%D0%B4%D1%83-repartition-%D0%B8-coalesce) –≤ —á–µ–º –∂–µ —Ä–∞–∑–Ω–∏—Ü–∞.  

### –ó–∞—á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å repartition 

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å —Ñ–∞–π–ª –≤ –∫–æ—Ç–æ—Ä–æ–º 150–∫ —Å—Ç—Ä–æ–∫. –í–µ—Å—å —Ñ–∞–π–ª –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ **–æ–¥–∏–Ω –±–ª–æ–∫ –¥–∞–Ω–Ω—ã—Ö** –∏ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —á—Ç–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–∏–º –±—É–¥–µ—Ç —Ç–æ–ª—å–∫–æ **–æ–¥–∏–Ω –≤–æ—Ä–∫–µ—Ä**. –ò –µ—Å–ª–∏ –Ω–∞ –≤—Ö–æ–¥–µ –º–æ–∂–µ—Ç –±—ã—Ç—å 2–ú–ë —Ç–æ –Ω–∞ –≤—ã—Ö–æ–¥–µ —É–∂–µ 1–ì–ë. –ò —ç—Ç–æ –≤—Å–µ –±—É–¥–µ—Ç –¥–µ–ª–∞—Ç—å **–æ–¥–∏–Ω –ø–æ—Ç–æ–∫**.  

<p align="center">
<img src="/../main/Questions_for_interview/Images/repartition_vs_coalesce.png" width="80%"></p>

–ú—ã –∑–Ω–∞–µ–º —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–ª–æ–∫–æ–≤ –≤ **–æ–¥–Ω–æ–º —ç—Ç–∞–ø–µ** –Ω–µ–∏–∑–º–µ–Ω–Ω–æ. –í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –º—ã –º–æ–∂–µ–º —Ä–∞–∑–æ—Ä–≤–∞—Ç—å —ç—Ç–∞–ø –Ω–∞ –¥–≤–∞, –¥–æ–±–∞–≤–∏–≤ **repartition(N)**, –∫–æ—Ç–æ—Ä—ã–π **–¥–µ–ª–∞–µ—Ç —à–∞—Ñ–ª**, —Å–æ–∑–¥–∞–≤–∞—è –Ω–∞ –≤—ã—Ö–æ–¥–µ **N –±–ª–æ–∫–æ–≤**, –ø—Ä–∏–º–µ—Ä–Ω–æ —Ä–∞–≤–Ω—ã—Ö –ø–æ —Ä–∞–∑–º–µ—Ä—É. –ò —Ç–∞–∫ –∫–∞–∫ –æ–Ω –¥–µ–ª–∞–µ—Ç **—à–∞—Ñ–ª** - —Å–æ–∑–¥–∞–µ—Ç—Å—è **–Ω–æ–≤—ã–π —ç—Ç–∞–ø**. 

<p align="center">
<img src="/../main/Questions_for_interview/Images/repartititon_new_stage.png" width="80%"></p>

–î–∞–ª—å—à–µ –Ω–∞–º –Ω—É–∂–Ω–æ –∑–∞–ø–∏—Å–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, –Ω–æ –ø–æ–Ω–∏–º–∞–µ–º —á—Ç–æ –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ç–∞—Å–æ–≤–∫–∏ —É –Ω–∞—Å 60 –±–ª–æ–∫–æ–≤ –∏ —Ç–∞–∫ –∫–∞–∫ –æ–¥–∏–Ω –±–ª–æ–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–¥–Ω–∏–º –ø–æ—Ç–æ–∫–æ–º —Ç–æ —É –Ω–∞—Å –±—É–¥–µ—Ç –∑–∞–ø–∏—Å–∞–Ω–æ 60 —Ñ–∞–π–ª–æ–≤. –í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç –º–µ—Ç–æ–¥ **coalesce(N) –∫–æ—Ç–æ—Ä—ã–π –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç repartition –Ω–µ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–µ—Ä–µ—Ç–∞—Å–æ–≤–∫–µ = –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–π —ç—Ç–∞–ø**, –∞ –ø—Ä–æ—Å—Ç–æ —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç –Ω–∞—à–∏ –±–ª–æ–∫–∏ –≤ N –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–ª–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ —Ç–æ–º—É —á—Ç–æ –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ —É –Ω–∞—Å –±—É–¥–µ—Ç **N –≤–æ—Ä–∫–µ—Ä–æ–≤**. –ò –µ—Å–ª–∏ –º—ã —Ä–µ—à–∏–º –∑–∞–ø–∏—Å–∞—Ç—å –≤—Å–µ –≤ **–æ–¥–∏–Ω —Ñ–∞–π–ª**, —Ç–æ —É –Ω–∞—Å –±—É–¥–µ—Ç –≤—Å–µ–≥–æ **–æ–¥–∏–Ω –≤–æ—Ä–∫–µ—Ä**, —Ç–æ –µ–º—É –±—É–¥–µ—Ç **—Ç—è–∂–µ–ª–æ** –≤—Å–µ —ç—Ç–æ **–≤—ã—á–∏—Å–ª—è—Ç—å**. –í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Å coalesce –¥–µ–ª–∞—é—Ç repartition, —á—Ç–æ–±—ã —Ä–∞–∑–±–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç—Ç–∞–ø –Ω–∞ –¥–≤–∞: 

1.   –ü—Ä–µ–¥–ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ç—è–∂–µ–ª—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è 

2.   –ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω—É–∂–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ 

#### –õ–æ–∂–∫–∞ –¥–µ–≥—Ç—è –∏ –∫–∞–∫ —Ñ–∏–∫—Å–∏—Ç—Å—è 

–ú—ã –∑–Ω–∞–µ–º —á—Ç–æ repartition —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ **—Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º**. –ò –∑–Ω–∞—è —á—Ç–æ –ø–∞—Ä–∫–µ—Ç —ç—Ç–æ –∫–æ–ª–æ–Ω–æ—á–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω–∏ –µ—â–µ –∏ **—Å–∂–∏–º–∞—é—Ç—Å—è** - –º—ã **—É—Ö—É–¥—à–∞–µ–º —Å–∂–∏–º–∞–µ–º–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö**. –≠—Ç–æ **—Ñ–∏–∫—Å–∏—Ç—Å—è** –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º **–ø–æ—Ä—è–¥–∫–∞** –Ω–æ –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞ –¥–∞–Ω–Ω—ã—Ö 

<p align="center">
<img src="/../main/Questions_for_interview/Images/repartition_order.png" width="80%"></p>

–¢–∞–∫ –∫–∞–∫ **—Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞** –∏–¥–µ—Ç –≤–Ω—É—Ç—Ä–∏ **–∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞**, —Ç–æ **–ø–µ—Ä–µ—Ç–∞—Å–æ–≤–∫–∏ –Ω–µ—Ç** –∏ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è –ø–∞–º—è—Ç–∏. –ü–æ—Å–ª–µ —Ç–∞–∫–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ **—Ä–∞–∑–º–µ—Ä** –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –±—É–¥–µ—Ç **–º–µ–Ω—å—à–µ** —Ç–∞–∫ –∫–∞–∫ –º—ã —É–ª—É—á—à–∏–ª–∏ —Å–∂–∏–º–∞–µ–º–æ—Å—Ç—å 

### –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É Repartition –∏ Coalesce 

-   Repartition - —ç—Ç–æ –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Ç–∞—Å–æ–≤–∫–∞ = –≤—Å–µ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç —à–∞—Ñ–ª = –Ω–æ–≤—ã–π —Å—Ç–µ–π–¥–∂ 

-   Coalesce - —Å–∫–ª–∞–¥—ã–≤–∞–Ω–∏–µ –±–ª–æ–∫–æ–≤ –∏ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–π —à–∞—Ñ–ª = –Ω–µ —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π —Å—Ç–µ–π–¥–∂ 

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç partitionBy

–¢—É—Ç –Ω—É–∂–Ω–æ —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å –æ —Ç–æ–º –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç repartition –≤ —Ç–æ–º —á–∏—Å–ª–µ. 

### Repartition 

```Repartion(numPartitions, partitionExprs)``` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤ —Å–µ–±—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä—Ç–∏—Ü–∏–π, –∞ —Ç–∞–∫–∂–µ –∫–æ–ª–æ–Ω–∫—É, –∫–æ—Ç–æ—Ä—É—é –≤ –±—É–¥—É—â–µ–º –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è. –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ? –û–±—ã—á–Ω—ã–π repartition –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è –∫–æ–ª–æ–Ω–∫–∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç **–≤—Å–µ —Ñ–∞–π–ª—ã –≤ –æ–¥–Ω—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é** –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —Ä–∞–≤–Ω–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–∞—Ä—Ç–∏—Ü–∏–π. –ï—Å–ª–∏ –∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ```partitionExprs(column)``` —Ç–æ –ø–∞—Ä—Ç–∏—Ü–∏–∏ –±—É–¥—É—Ç –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å—Å—è –ø—É—Ç–µ–º —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —á—Ç–æ –≤—Å–µ –∑–∞–ø–∏—Å–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ–ª–æ–Ω–∫–∏ –±—É–¥—É—Ç –ª–µ–∂–∞—Ç—å –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ 

### PartitionBy

–í ```partitionBy(colNames : String*)``` –º—ã –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–∫–∏–¥—ã–≤–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –ø–∞—Ä—Ç–∏—Ü–∏—è. –ü—Ä–∏—á–µ–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø–∞—Ä—Ç–∏—Ü–∏–∏ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–∞—è —Å—É–±–¥–µ—Ä–∏–∫—Ç–æ—Ä–∏—è.

## PartitionBy –≤ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ —Å repartition –∏–ª–∏ coalesce

–ö–∞–∫ –±—ã–ª–æ —Å–∫–∞–∑–∞–Ω–æ –≤—ã—à–µ, **repartition —Å–æ–∑–¥–∞–µ—Ç –ø–∞—Ä—Ç–∏—Ü–∏–∏**, –ø—Ä–æ–∫–∏–¥—ã–≤–∞—è **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä—Ç–∏—Ü–∏–π**, –∞ **partitionby** –¥–µ–ª–∞–µ—Ç –ø–∞—Ä—Ç–∏—Ü–∏–∏ –ø–æ **–∫–æ–ª–∏—á–µ—Å—Ç–≤—É —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∫–æ–ª–æ–Ω–∫–∏**. –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö **–≤–º–µ—Å—Ç–µ**, —Ç–æ **—Å–Ω–∞—á–∞–ª–∞** –ø–∞—Ä—Ç–∏—à–Ω–±–∞–π —Å–¥–µ–ª–∞–µ—Ç **–ø–∞–ø–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ–ª–æ–Ω–∫–∏**, –∞ —Ä–µ–ø–∞—Ä—Ç–∏—à–Ω –ø–æ—Ç–æ–º **—Ä–∞–∑–¥–µ–ª–∏—Ç —Ñ–∞–π–ª –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω—É–∂–Ω—ã—Ö –ø–∞—Ä—Ç–∏—Ü–∏–π**. 

<p align="center">
<img src="/../main/Questions_for_interview/Images/partition_by.png" width="80%"></p>


## –ö–∞–∫ —É–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ shuffle

Shuffle - —ç—Ç–æ –ø–µ—Ä–µ—Ç–∞—Å–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –ø–∞—Ä—Ç–∏—Ü–∏—è–º–∏ –∏ –≤ —ç—Ç–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ –∫–∞–∂–¥—ã–π –º–∞–ø–ø–µ—Ä (M) –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á—É –∫–∞–∂–¥–æ–º—É —Ä–µ–¥—å—é—Å–µ—Ä—É (R) —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Å–æ–∑–¥–∞–Ω–∏—é –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É (M*R) —Ñ–∞–π–ª–æ–≤, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –±–æ–ª—å—à–∏–º —Ä–∞—Å—Ö–æ–¥–∞–º. –ï—Å—Ç—å –º–Ω–æ–≥–æ —Ç–µ—Ö–Ω–∏–∫ –∫–∞–∫ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —à–∞—Ñ–ª—ã (—Ç–∏–ø —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å, —É–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–≤–æ –¥–∞–Ω–Ω—ã—Ö –∏—Ç–¥) –Ω–æ –º—ã —Å–µ–π—á–∞—Å –≥–æ–≤–æ—Ä–∏–º –ø—Ä–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∞–º–∏—Ö —à–∞—Ñ–ª–æ–≤. 

### spark.sql.shuffle.partitions 

Spark SQL shuffle —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º –æ—Ç–≤–µ—á–∞—é—â–∏–π –∑–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏ —Ä–µ–ø–∞—Ä—Ç–∏—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö –∏ —Å –ø–æ–º–æ—â—å—é –Ω–µ–≥–æ –º—ã –º–æ–∂–µ–º —É–≤–µ–ª–∏—á–∏—Ç—å –∏–ª–∏ —É–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä—Ç–∏—Ü–∏–π –≤ RDD/DF –∏—Å–ø–æ–ª—å–∑—É—è ```spark.sql.shuffle.partitions```. –ü–æ –¥–µ—Ñ–æ–ª—Ç—É —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è —Ä–∞–≤–Ω–æ 200, –Ω–æ –≤ —ç—Ç–æ–º –Ω–µ—Ç —Å–º—ã—Å–ª–∞ –µ—Å–ª–∏ —É –Ω–∞—Å –Ω–µ–º–Ω–æ–≥–æ –¥–∞–Ω–Ω—ã—Ö. –ü–æ—ç—Ç–æ–º—É –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–µ–Ω—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —á—Ç–æ–±—ã —É–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞—Ñ–ª–æ–≤.  

–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —ç—Ç–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è, —Å–ø–∞—Ä–∫ –≤—ã–±–∏—Ä–∞–µ—Ç –∫–∞–∫–æ–π —à–∞—Ñ–ª –ø—Ä–∏–º–µ–Ω—è—Ç—å. –ü—Ä–∏ –∑–Ω–∞—á–µ–Ω–∏–∏ ```spark.sql.shuffle.partitions<200``` –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º –±—É–¥–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º **hash shuffle**. –ü—Ä–∏ ```spark.sql.shuffle.partitions>200```, —Ç–æ sort **based shuffle** 

### Broadcast Hash Join 

–ö–æ–≥–¥–∞ –º—ã –¥–∂–æ–π–Ω–∏–º –¥–≤–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ –∏ –æ–¥–∏–Ω –∏–∑ –Ω–∏—Ö **–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–∞–ª**, —á—Ç–æ–±—ã **–ø–æ–º–µ—Å—Ç–∏—Ç—å—Å—è** –≤ –ø–∞–º—è—Ç—å **–æ–¥–Ω–æ–≥–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è**, —Ç–æ –æ–Ω –≥—Ä—É–∑–∏—Ç—Å—è –≤ **—Ö–µ—à-—Ç–∞–±–ª–∏—Ü—É** –Ω–∞ **–¥—Ä–∞–π–≤–µ—Ä** –∏ —Ç—Ä–∞–Ω—Å–ª–∏—Ä—É–µ—Ç—Å—è –∫–∞–∂–¥–æ–º—É –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é. –ò —Ç–æ–≥–¥–∞ –º–µ–ø —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –º–æ–∂–µ—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —ç—Ç–æ–π —Ö–µ—à-—Ç–∞–±–ª–∏—Ü–µ —á—Ç–æ–±—ã –ª—É–∫–∞–ø–∏—Ç—å –¥–∞–Ω–Ω—ã–µ 

### –í–º–µ—Å—Ç–æ repartition –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å coalesce 

–í –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ —è –≥–æ–≤–æ—Ä–∏–ª —á—Ç–æ repartition –≤—Å–µ–≥–¥–∞ –¥–µ–ª–∞–µ—Ç —à–∞—Ñ–ª, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç coalesce, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å—Ç–∞—Ä–∞—Ç—å—Å—è –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –±–ª–æ–∫–∏ –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è. 

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å aggregateByKey() –≤–º–µ—Å—Ç–æ groupByKey() 

–í–æ–æ–±—â–µ ```groupbykey()``` –æ–ø–∞—Å–Ω–æ —é–∑–∞—Ç—å —Ç–∞–∫ –∫–∞–∫ –æ–Ω —á–∞—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–∞–º—è—Ç—å—é. –ß—Ç–æ –æ–Ω –¥–µ–ª–∞–µ—Ç? –û–Ω —Å–Ω–∞—á–∞–ª–∞ —à–∞—Ñ–ª–∏—Ç –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –∞ –ø–æ—Ç–æ–º –∏—Ö –º–µ—Ä–¥–∂–∏—Ç —á—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å. –ü–æ—ç—Ç–æ–º—É –º—ã –º–æ–∂–µ–º —é–∑–∞—Ç—å ```reducebykey``` –∏–ª–∏ ```aggregatebykey``` (–æ–Ω–∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–µ–º —á—Ç–æ –≤ –∞–≥—Ä–µ–≥–∞—Ç –º–æ–∂–Ω–æ –ø—Ä–æ–∫–∏–Ω—É—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –ª–æ–≥–∏–∫—É –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è). –ö–∞–∫ –æ–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç? –°–Ω–∞—á–∞–ª–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è **–∫–æ–º–±–∞–π–Ω–µ—Ä** –∫–æ—Ç–æ—Ä—ã–π **–º–µ—Ä–¥–∂–∏—Ç** –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ –∫–ª—é—á–∞–º –∏ —Ç–æ–ª—å–∫–æ **–ø–æ—Ç–æ–º –∑–∞–ø—É—Å–∫–∞–µ—Ç —à–∞—Ñ–ª** —á—Ç–æ –¥–∞–µ—Ç –±–æ–ª—å—à–∏–π –ø–µ—Ä—Ñ–æ–º–∞–Ω—Å 


## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–æ—Ç–æ—Ä—ã–µ —é–∑–∞–µ—Ç –∫–∞—Ç–∞–ª–∏—Å—Ç

–ö —É–∑–ª–∞–º –¥–µ—Ä–µ–≤–∞ Catalyst –ø—Ä–∏–º–µ–Ω—è–µ—Ç –Ω–∞–±–æ—Ä –ø—Ä–∞–≤–∏–ª –¥–ª—è –∏—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —á–µ—Ç—ã—Ä–µ —ç—Ç–∞–ø–∞, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∞ –¥–∏–∞–≥—Ä–∞–º–º–µ –Ω–∏–∂–µ. 

<p align="center">
<img src="/../main/Questions_for_interview/Images/catalyst.png" width="80%"></p>

### –ê–Ω–∞–ª–∏–∑ 

–ö–æ–≥–¥–∞ –∫ –Ω–∞–º –ø—Ä–∏–ª–µ—Ç–∞—é—Ç –¥–∞–Ω–Ω—ã–µ –∫–∞—Ç–∞–ª–∏—Å—Ç **–Ω–µ –∑–Ω–∞–µ—Ç –≤–æ–æ–±—â–µ –Ω–∏—á–µ–≥–æ** –æ –Ω–∏—Ö, –Ω–∏ –æ —Ç–∏–ø–∞—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–∞–∑–≤–∞–Ω–∏–π –∫–æ–ª–æ–Ω–æ–∫ –∏—Ç–¥. –ü–æ—ç—Ç–æ–º—É –∫–æ–≥–¥–∞ –º—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å, —Å–ø–∞—Ä–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–∞—Ç–∞–ª–∏—Å—Ç —á—Ç–æ–±—ã **–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø** –∫–∞–∂–¥–æ–≥–æ –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –∏ **—Å—É—â–µ—Å—Ç–≤—É—é—Ç –ª–∏ –æ–Ω–∏ –≤–æ–æ–±—â–µ**. –°–Ω–∞—á–∞–ª–∞ –∫–∞—Ç–∞–ª–∏—Å—Ç **—Å–æ–∑–¥–∞–µ—Ç –¥–µ—Ä–µ–≤–æ** –¥–ª—è **–Ω–µ—Ä–∞–∑—Ä–µ—à–µ–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –ø–ª–∞–Ω–∞** –∏ –∑–∞—Ç–µ–º **–ø—Ä–∏–º–µ–Ω—è–µ—Ç** —Å–≤–æ–∏ **–ø—Ä–∞–≤–∏–ª–∞** —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤—Å–µ **—Å—Å—ã–ª–∫–∏** –Ω–∞ –∞—Ç—Ä–∏–±—É—Ç—ã –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è. –î–ª—è —ç—Ç–æ–≥–æ –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—ä–µ–∫—Ç **Catalog** –∫–æ—Ç–æ—Ä—ã–π –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—ã –≤–æ –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö –¥–∞–Ω–Ω—ã—Ö 

### –õ–æ–≥–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è 

–ü–æ—Å–ª–µ –≤–µ—Ä—Å–∏–∏ 2.2 –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä –∑–∞—Ç—Ä–∞—Ç –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É** –∏ **–º–æ—â–Ω–æ—Å—Ç–∏** –º–∞—à–∏–Ω—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ –Ω–∞–∏–±–æ–ª–µ–µ **—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ** –ø–ª–∞–Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –ø—Ä–∞–≤–∏–ª. –ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –∫–∞—Ç–∞–ª–∏—Å—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –∑–∞—Ç—Ä–∞—Ç—ã –∏ **–≥–æ—Ç–æ–≤—ã–π –ø–ª–∞–Ω** –∫–∏–¥–∞–µ—Ç –≤ **—Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø** 

### –§–∏–∑–∏—á–µ—Å–∫–∏–π –ø–ª–∞–Ω 

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç **–Ω–µ—Å–∫–æ–ª—å–∫–æ** —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –ø–ª–∞–Ω–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞ **–Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ** –∏–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã—Ö 

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ 

–≠—Ç–∞–ø —Å–æ–∑–¥–∞–Ω–∏—è **–±–∞–π—Ç-–∫–æ–¥–∞ Java** –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–∞ –∫–∞–∂–¥–æ–π –º–∞—à–∏–Ω–µ. –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è Scala ‚Äì QuasiQuotes –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–µ—Ä–µ–≤–∞ –∑–∞–¥–∞–Ω–∏—è –≤ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–æ–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–æ–µ –¥–µ—Ä–µ–≤–æ (AST) –∫–æ—Ç–æ—Ä–æ–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–¥ 

## –ö–∞–∫ —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É Data Skew –∏ –≤–æ–æ–±—â–µ —á—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ

Data Skew - —ç—Ç–æ **–ø–µ—Ä–µ–∫–æ—Å** –¥–∞–Ω–Ω—ã—Ö, –¥—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏ —ç—Ç–æ –∫–æ–≥–¥–∞ *–¥–∞–Ω–Ω—ã—Ö* –≤ –æ–¥–Ω–æ–π –ø–∞—Ä—Ç–∏—Ü–∏–∏ –≥–æ—Ä–∞–∑–¥–æ **–±–æ–ª—å—à–µ** —á–µ–º –≤ –¥—Ä—É–≥–∏—Ö (—ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω–æ —à–∞—Ñ–ª–æ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π). –ü–æ—á–µ–º—É —ç—Ç–æ –ø–ª–æ—Ö–æ? –°–ø–∞—Ä–∫ –º–æ–∂–µ—Ç –∑–∞–∫–∏–Ω—É—Ç—å —ç—Ç—É –ø–∞—Ä—Ç–∏—Ü–∏—é –≤ **–æ–ø–µ—Ä–∞—Ç–∏–≤–∫—É** –∏ —Ç–æ–≥–¥–∞ –≤—Å–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –æ—á–µ–Ω—å **–º–µ–¥–ª–µ–Ω–Ω–æ**, –∞ –µ—Å–ª–∏ –ø–∞–º—è—Ç–∏ –Ω–µ —Ö–≤–∞—Ç–∏—Ç - OOM 

### Broadcast Hash Join  

–û–±—Å—É–∂–¥–∞–ª–∏ —ç—Ç–æ—Ç —Ç–∏–ø –¥–∂–æ–π–Ω–∞ –≤—ã—à–µ. –ò–∑ **–Ω–∞–∏–º–µ–Ω—å—à–µ–≥–æ** –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞ –¥–µ–ª–∞–µ—Ç—Å—è **—Ö–µ—à-—Ç–∞–±–ª–∏—Ü–∞** –∏ –∫–∏–¥–∞–µ—Ç—Å—è –Ω–∞ **–¥—Ä–∞–π–≤–µ—Ä**, –¥—Ä–∞–π–≤–µ—Ä **—Å–æ–µ–¥–∏–Ω–∏—Ç** –∫—É—Å–æ—á–∫–∏ —Ö–µ—à-—Ç–∞–±–ª–∏—Ü—ã —Å **—Ä–∞–∑–Ω—ã—Ö —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤** –∏ –ø–æ—Ç–æ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç —ç—Ç—É **—Ö–µ—à-–º–∞–ø—É** –Ω–∞ **–≤—Å–µ—Ö** —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤. –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∫–∏–¥–∞—Ç—å –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã –Ω–∞ –¥—Ä–∞–π–≤–µ—Ä, —ç—Ç–æ –º–æ–∂–µ—Ç –ø–ª–æ—Ö–æ –∫–æ–Ω—á–∏—Ç—Å—è. –ö—Ä–æ–º–µ —Ç–æ–≥–æ AQE –º–æ–∂–µ—Ç —Ä–µ—à–∏—Ç—å –¥–µ–ª–∞—Ç—å —ç—Ç–æ—Ç –¥–∂–æ–π–Ω –∏–ª–∏ –Ω–µ—Ç, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–ø—Ä–æ–≤–æ—Ü–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ –Ω–∞–ø—Ä—è–º—É—é, —Ç–æ –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º –¥–∂–æ–π–Ω–∞ —Å –ø–æ–º–æ—â—å—é —Ö–∏–Ω—Ç–∞ 
 
### –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Å–æ–ª—å—é (salting) 

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–Ω–¥–æ–º–Ω—ã—Ö (–≤ –ø–ª–∞–Ω–µ –º—ã —Å–∞–º–∏ –≤—ã–±–∏—Ä–∞–µ–º —á—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å) –¥–∞–Ω–Ω—ã—Ö –∫–æ—Ç–æ—Ä—ã–µ –∫ –∫–ª—é—á—É, –¥–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å **—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–π** –¥–ª—è —Ö–µ—à–∞. 

–í —Å–ø–∞—Ä–∫–µ –¥–µ–ª–∞–µ—Ç—Å—è —Ç–∞–∫: 

1.  –°–æ–∑–¥–∞–µ–º –∫–æ–ª–æ–Ω–∫—É —Å —Ä–∞–Ω–¥–æ–º–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ 

2.  –ö–æ–º–±–∏–Ω–∏—Ä—É–µ–º –Ω–æ–≤—É—é –∫–æ–ª–æ–Ω–∫—É —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∫–ª—é—á–∞–º–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–º–ø–æ–∑–∏—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –∏ –¥–µ–ª–∞–µ–º –ª—é–±—É—é —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é 

3.  –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç 

<p align="center">
<img src="/../main/Questions_for_interview/Images/hashing_with_salt.png" width="80%"></p>

### AQE 

–í —Å–ª—É—á–∞–µ —Å Data Skew —Ä–∞–±–æ—Ç–∞–µ—Ç —Å **sort merge join**. –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —à–∞—Ñ–ª–∞ —Å–æ–±–∏—Ä–∞–µ—Ç **—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É** –∏ —Ä–µ—à–∞–µ—Ç —á—Ç–æ –ª—É—á—à–µ —Å–¥–µ–ª–∞—Ç—å. –ù–∞–ø—Ä–∏–º–µ—Ä –µ—Å–ª–∏ –æ–¥–Ω–∞ –∏–∑ –ø–∞—Ä—Ç–∏—Ü–∏–π –±—É–¥–µ—Ç —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π —Ç–æ AQE –º–æ–∂–µ—Ç —Å–∞–º –∑–∞—Å–æ–ª–∏—Ç—å —ç—Ç—É –ø–∞—Ä—Ç–∏—Ü–∏—é –∏ —Å–¥–µ–ª–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ä—Ç–∏—Ü–∏–π –ø–æ–º–µ–Ω—å—à–µ. 


## UDF –∏ –ø–æ—á–µ–º—É PySpark UDF —ç—Ç–æ –ø–ª–æ—Ö–æ. –ß–µ–º –∑–∞–º–µ–Ω–∏—Ç—å PySpark UDF

–ö–æ–≥–¥–∞ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞, –Ω–∞ –ø–æ–º–æ—â—å –ø—Ä–∏—Ö–æ–¥—è—Ç UDF. –ü–æ —Å—É—Ç–∏ –æ–±—ã—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–±–æ—Ç–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏. –ï—Å—Ç—å —Ç—Ä–∏ –≤–∏–¥–∞: PySpark UDF, Pandas UDF, Scala UDF. –í —Ü–µ–ª–æ–º –æ—á–µ–≤–∏–¥–Ω–æ —Å–∞–º–∞—è **–±—ã—Å—Ç—Ä–∞—è Scala UDF**, –Ω–∞ –≤—Ç–æ—Ä–æ–º –º–µ—Å—Ç–µ **Pandas UDF** —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å **–≤–µ–∫—Ç–æ—Ä–∞–º–∏**, –Ω—É –∏ —Å–∞–º–∞—è –º–µ–¥–ª–µ–Ω–Ω–∞—è **PySpark UDF** —Ç–∞–∫ –∫–∞–∫ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç **–ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ**. –ù–∞ Scala –æ—á–µ–≤–∏–¥–Ω–æ –≤—ã –±—É–¥–µ—Ç–µ —é–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ Scala UDF, –Ω–æ –Ω–∞ PySpark —á–∞—â–µ –≤—Å–µ–≥–æ PySpark UDF. –¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, –µ—Å–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ UDF —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–æ–±–ª–µ–º–æ–π(–ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏), —Ç–æ —Å—Ç–æ–∏—Ç **–∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ Pandas UDF**. –ù—É –∞ –≤–æ–æ–±—â–µ –ª—É—á—à–µ –∏—Ö –Ω–µ —é–∑–∞—Ç—å, –∏–±–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ç–æ—Ä –∏—Ö –Ω–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç(–æ–Ω –∂–µ –Ω–µ –∑–Ω–∞–µ—Ç —á—Ç–æ –≤—ã —Ç–∞–º –Ω–∞–ø–∏—à–∏—Ç–µ), –¥–∞ –∏ —Ç–µ –∂–µ PySpark UDF —Ä–µ–∞–ª—å–Ω–æ –º–µ–¥–ª–∏—Ç–µ–ª—å–Ω—ã. 


## Delta Lake –∏ –ø–æ—á–µ–º—É –æ–Ω

–°–∞–º **Data Lake** –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ–ª–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ **merge, update, delete** –∏—Ç–¥ –ø–æ—Ç–æ–º—É —á—Ç–æ —Ñ–∞–π–ª—ã —Ç–∞–º **–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç ACID**. –†–µ—à–µ–Ω–∏–µ–º —è–≤–ª—è–µ—Ç—Å—è –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ **JSON** —Ñ–∞–π–ª–∞ –∫–æ—Ç–æ—Ä—ã–π **—Ö—Ä–∞–Ω–∏—Ç** –≤ —Å–µ–±–µ **–ª–æ–≥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é** –≤—Ä–æ–¥–µ –∑–∞–≥—Ä—É–∑–æ–∫, –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏—Ç–¥. –ë–ª–∞–≥–æ–¥–∞—Ä—è —ç—Ç–æ–º—É –Ω–∞—à–∏ **—Ñ–∞–π–ª—ã —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å ACID** –ø—Ä–∞–≤–∏–ª–∞–º–∏ –∏ —Å –ø–æ–º–æ—â—å—é Delta API –º—ã –º–æ–∂–µ–º –¥–µ–ª–∞—Ç—å update, delete, merge –∏ –¥–∞–∂–µ —Å–º–æ—Ç—Ä–µ—Ç—å **–ø—Ä–æ—à–ª—ã–µ —Ñ–∞–π–ª—ã** —Ç–∫ –º—ã –≤–∏–¥–∏–º –ª–æ–≥ –∏ –∑–Ω–∞–µ–º –∫–æ–≥–¥–∞ —á—Ç–æ –¥–æ–±–∞–≤–ª—è–ª–æ—Å—å, –æ–±–Ω–æ–≤–ª—è–ª–æ—Å—å –∏—Ç–¥. –ü—Ä–∏—á–µ–º Delta API –Ω–µ —É–¥–∞–ª—è–µ—Ç —Ñ–∞–π–ª—ã –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∫–∞–∫ –≤—ã –ø–æ–Ω—è–ª–∏, –æ–Ω –ø—Ä–æ—Å—Ç–æ —Ö—Ä–∞–Ω–∏—Ç —Ñ–∞–π–ª—ã –∏ –ª–æ–≥–∏ —Å –Ω–∏–º–∏. –î–ª—è —É–¥–∞–ª–µ–Ω–∏—è –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ```vacuum```. 

## –°—Ç—Ä–∏–º–∏–Ω–≥ –≤ Spark

text

## –ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –ø–∞–º—è—Ç–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ JVM+overhead

–î–æ —Å–ø–∞—Ä–∫–∞ 1.6 –º–µ—Ö–∞–Ω–∏–∑–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –±—ã–ª –¥—Ä—É–≥–∏–º –∏ –æ–ø—Ä–µ–¥–µ–ª—è–ª—Å—è –∫–ª–∞—Å—Å–æ–º StaticMemoryManager. –° –≤–µ—Ä—Å–∏–µ–π 1.6 –∏ –≤—ã—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—å –ø–∞–º—è—Ç–∏ –Ω–∞ —Å–µ–±—è –≤–∑—è–ª UnifiedMemoryManager –∫–ª–∞—Å—Å. 

–ù–∞—á–Ω–µ–º —Å —Ç–æ–≥–æ, —á—Ç–æ –æ—Å–Ω–æ–≤–Ω—ã–º —è–∑—ã–∫–æ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –°–ø–∞—Ä–∫–∞ —è–≤–ª—è–µ—Ç—Å—è Scala –ø–æ—ç—Ç–æ–º—É –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–∞–Ω—è—Ç—Å—è –Ω–∞ JVM. –°—Ä–µ–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–æ **Heap** (–∫—É—á–∞), –∫–æ—Ç–æ—Ä–∞—è –¥–µ–ª–∏—Ç—Å—è –Ω–∞ 4 (Spark Memory —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ Storage Memory –∏ Execution Memory) —Ä–∞–∑–Ω—ã–µ —á–∞—Å—Ç–∏.  

<p align="center">
<img src="/../main/Questions_for_interview/Images/jvm_heap.png" width="80%"></p>

–ö—Ä–æ–º–µ —Ç–æ–≥–æ –µ—Å—Ç—å –µ—â–µ –¥–≤–∞ —Å–µ–≥–º–µ–Ω—Ç–∞ –ø–∞–º—è—Ç–∏ –∫ –∫–æ—Ç–æ—Ä—ã–º –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –°–ø–∞—Ä–∫: 

-   –ü–∞–º—è—Ç—å –≤–Ω–µ –∫—É—á–∏ (Off-Heap Memory) - —Å–µ–≥–º–µ–Ω—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ JVM –∫–æ—Ç–æ—Ä—ã–π –∏–Ω–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞–ø—Ä–∏–º–µ—Ä –¥–ª—è –º–µ—Ç–æ–¥–∞ ```intern()```, –∫–æ—Ç–æ—Ä—ã–π –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —á—Ç–æ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º —Å–æ–≤–º–µ—Å—Ç–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–Ω—É –∏ —Ç—É –∂–µ –ø–∞–º—è—Ç—å. –ö—Ä–æ–º–µ —Ç–æ–≥–æ –ø–∞–º—è—Ç—å –≤–Ω–µ –∫—É—á–∏ –º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º—ã –∏ RDD. 

-   –í–Ω–µ—à–Ω—è—è –ø–∞–º—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞ (External Process Memory) - —ç—Ç—É –ø–∞–º—è—Ç—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–æ–≥—Ä–∞–º—ã PySpark, SparkR –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–Ω—è—Ç—Å—è –Ω–∞ Python –∏ R –≤–Ω–µ JVM. 

–¢–∞–∫ –∂–µ –Ω–∞–¥–æ —Å–∫–∞–∑–∞—Ç—å –ø—Ä–æ –¥–≤–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (—Ç–∞–∫ –∏—Ö 10 –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é –Ω–æ –¥–ª—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Ç–æ–ª—å–∫–æ 2): 

-   ```spark.memory.fraction (defaults to 0.75)``` - —Å–µ–≥–º–µ–Ω—Ç –æ—Ç 300–ú–ë –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è **—Ö—Ä–∞–Ω–µ–Ω–∏—è** –¥–∞–Ω–Ω—ã—Ö.  –ß–µ–º –æ–Ω–æ **–º–µ–Ω—å—à–µ** —Ç–µ–º **—á–∞—â–µ** –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **—É—Ç–µ—á–∫–∞** –∏ **–≤—ã—Ç–µ—Å–Ω–µ–Ω–∏–µ** –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–¥–µ–ª–∏—Ç—å –ø–∞–º—è—Ç—å –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω–Ω—ã—Ö. 

-   ```memory.storageFraction (defaults to 0.5)``` - —á–∞—Å—Ç—å spark.memory.fraction, –æ–±—å–µ–º –ø–∞–º—è—Ç–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤—ã—Ç–µ—Å–Ω–∏—Ç—å. –ß–µ–º –±–æ–ª—å—à–µ —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–µ–º –º–µ–Ω—å—à–µ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –∑–∞–¥–∞—á–∏ —á–∞—â–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ –¥–∏—Å–∫. 

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø–æ–≥–æ–≤–æ—Ä–∏—Ç—å –ø—Ä–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –≤ Heap: 

### Reserved Memory (–∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–∞–º—è—Ç—å)  

–ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–æ–π –∏ —Å –≤–µ—Ä—Å–∏–∏ 1.6 —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 300–ú–ë. –≠—Ç–∞ –ø–∞–º—è—Ç—å —Ö—Ä–∞–Ω–∏—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ–±—å–µ–∫—Ç—ã —Å–ø–∞—Ä–∫–∞. –ü—Ä–∏–∫–æ–ª –≤ —Ç–æ–º —á—Ç–æ –µ—Å–ª–∏ –ø–∞–º—è—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è –±—É–¥–µ—Ç –º–µ–Ω—å—à–µ —á–µ–º –≤ 1.5 —Ä–∞–∑–∞ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏, —Ç–æ —Å–ø–∞—Ä–∫ –¥–∞—Å—Ç –æ—à–∏–±–∫—É "Please use larger heap size" 

–§–æ—Ä–º—É–ª–∞ –ø–æ–¥—Å—á–µ—Ç–∞: –î–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ 300–ú–ë 

### User Memory (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –ø–∞–º—è—Ç—å)  

–î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö **–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º**, UDF –∏—Ç–¥. –≠—Ç–æ—Ç —Å–µ–≥–º–µ–Ω—Ç –ø–∞–º—è—Ç–∏ –Ω–µ —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–ø–∞—Ä–∫–æ–º. 

–§–æ—Ä–º—É–ª–∞ –ø–æ–¥—Å—á–µ—Ç–∞: (Heap (—Å–∫–æ–ª—å–∫–æ —É –Ω–∞—Å –≤—Å–µ–≥–æ –ø–∞–º—è—Ç–∏ –≤ –∫—É—á–µ) - Reserved Memory (–∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–∞–º—è—Ç—å)) * (1.0 -  ```spark.memory.fraction``` (—ç—Ç–æ —Å–∫–æ–ª—å–∫–æ –º—ã –æ—Ç–¥–∞–µ–º –≤ —Å–∞–º—É –ø–∞–º—è—Ç—å —Å–ø–∞—Ä–∫–∞))  

### Storage Memory (–ø–∞–º—è—Ç—å —Ö—Ä–∞–Ω–∏–ª–∏—â–∞) 

–ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–∞–º—è—Ç—å –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö. –°–ø–∞—Ä–∫ **—á–∏—Å—Ç–∏—Ç** –º–µ—Å—Ç–æ –¥–ª—è **–Ω–æ–≤—ã—Ö** —Ñ–∞–π–ª–æ–≤ –ø—É—Ç–µ–º **—É–¥–∞–ª–µ–Ω–∏—è —Å—Ç–∞—Ä—ã—Ö** –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –ø–æ –º–µ—Ö–∞–Ω–∏–∑–º—É **LRU** (Least Recently Used). –ö–æ–≥–¥–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø–æ–ª–Ω–∏–ª–∏ –¥–∏—Å–∫ –æ–Ω–∏ –±—É–¥—É—Ç –∏–ª–∏ –∑–∞–ø–∏—Å–∞–Ω—ã –Ω–∞ –¥–∏—Å–∫ –∏–ª–∏ –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏. 

–§–æ—Ä–º—É–ª–∞ –ø–æ–¥—Å—á–µ—Ç–∞: Storage Memory = (Heap ‚Äì Reserved Memory) * ```spark.memory.fraction``` * ```spark.memory.storageFraction``` (–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞–∫–æ–π –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç —Å–ø–∞—Ä–∫–æ–≤—Å–∫–æ–π –ø–∞–º—è—Ç–∏ –º—ã –æ—Ç–¥–∞–µ–º –ø–æ–¥ —Ö—Ä–∞–Ω–µ–Ω–∏–µ) 

### Execution Memory (–ø–∞–º—è—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è) 

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è **—Ç–∞—Å–∫–æ–≤**. –ö–∞–∫ –ø—Ä–∞–≤–∏512–ú–ë–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è **—Ö–µ—à-—Ç–∞–±–ª–∏—Ü** –∏–ª–∏ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è **–±—É—Ñ–µ—Ä–∞ —à–∞—Ñ–ª–∞**. –¢–∞–∫ –∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **spilling** –Ω–∞ –¥–∏—Å–∫ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–µ –ø–∞–º—è—Ç–∏. 

–§–æ—Ä–º—É–ª–∞ –ø–æ–¥—Å—á–µ—Ç–∞: (Heap ‚Äì Reserved Memory) * ```spark.memory.fraction``` * (1.0 - ```spark.memory.storageFraction``` (—Ç–æ –µ—Å—Ç—å –æ—Å—Ç–∞—Ç–æ–∫ –æ—Ç —á–∞—Å—Ç–∏ —Å–ø–∞—Ä–∫–æ–≤—Å–∫–æ–π –ø–∞–º—è—Ç–∏ –∫–æ—Ç–æ—Ä—É—é –º—ã –æ—Ç–¥–∞–ª–∏ –ø–æ–¥ —Ö—Ä–∞–Ω–µ–Ω–∏–µ) 

### –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ –∏ –ø–∞–º—è—Ç–∏ –≤–Ω–µ –∫—É—á–∏ 

–ü–æ–º–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏ –≤ –∫—É—á–µ JVM –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –º–æ–∂–µ—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –≤–Ω–µ—à–Ω–µ–º—É –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤—É —á–µ—Ä–µ–∑ API –∏–Ω—Ç–µ—Ñ–µ–π—Å—ã ```sun.misc.Unsafe``` –ü–∞–º—è—Ç—å –≤–Ω–µ –∫—É—á–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ —Å–±–æ—Ä–∫–∏ –º—É—Å–æ—Ä–∞ –ø–æ—ç—Ç–æ–º—É –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –ø–∞–º—è—Ç—å—é. –°–ø–∞—Ä–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–∞–º—è—Ç—å –≤–Ω–µ –∫—É—á–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–∞–º—è—Ç—å—é –∑–∞ —Å—á–µ—Ç –º–µ—Ç–æ–¥–∞ ```string.intern()```. –¢–∞–∫ –∂–µ –ø–∞–º—è—Ç—å –≤–Ω–µ –∫—É—á–∏ –Ω—É–∂–Ω–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞–º–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞ **Tungsten** (—ç—Ç–æ —Ç–∞–∫–∞—è —à—Ç—É–∫–∞ –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ä–∞–∑—É —Å —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–º –±–∏–Ω–∞—Ä–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏) –∫–æ—Ç–æ—Ä—ã–π –ø–æ–≤—ã—à–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö. 

–û–±—â–∞—è –ø–∞–º—è—Ç—å –≤–Ω–µ –∫—É—á–∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è ```spark.executor.memoryOverhead``` –∫–æ—Ç–æ—Ä—ã–π –ø–æ –¥–µ—Ñ–æ–ª—Ç—É —Ä–∞–≤–µ–Ω 10% –ø–∞–º—è—Ç–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è –Ω–æ –Ω–µ –Ω–∏–∂–µ 384–ú–ë. –≠—Ç–æ—Ç –æ–±—ä–µ–º –≤—ã–¥–µ–ª—è–µ—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è –∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–º. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ **YARN** –∏ **Kubernetes** 

–≠—Ç–∞ –ø–∞–º—è—Ç—å —Ç–∞–∫ –∂–µ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –ø–∞–º—è—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è PySpark (–µ—Å–ª–∏ ```spark.executor.pyspark.memory``` –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –æ—Ç–¥–µ–ª—å–Ω–æ). 

## –ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç –ø–∞–º—è—Ç–∏ –Ω–∞ –ø–æ–ª–Ω–æ–º —É—Ä–æ–≤–Ω–µ(–µ—Å–ª–∏ —ç—Ç–æ PySpark —Ç–æ —Ç–∞–º –Ω–µ —Ç–æ–∫ JVM –∏ overhead)

–ö —Å—Ç–∞—Ç—å–µ –≤—ã—à–µ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —á—Ç–æ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫–æ–¥–∞ –Ω–∞ PySpark –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —É—á–∞—Å—Ç–∫–∏ –ø–∞–º—è—Ç–∏ –∑–∞–¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ ```spark.python.worker.memory``` –∏ ```spark.executor.pyspark.memory``` –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å —Ä–∞–Ω–∏—Ç –¥–≤–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞, –∫–æ—Ç–æ—Ä—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º —á–µ—Ä–µ–∑ –º–æ—Å—Ç Py4J: 

-   JVM - –≤—ã–ø–æ–ª–Ω—è–µ—Ç —á–∞—Å—Ç—å –∫–æ–¥–∞ –°–ø–∞—Ä–∫–∞ –∫–æ—Ç–æ—Ä—ã–π —Å–≤—è–∑–∞–Ω —Å —à–∞—Ñ–ª–æ–º 

-   Python - —Ä–∞–Ω–∏—Ç —Å–∞–º –∫–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 

 
–ü–∞—Ä–∞–º–µ—Ç—Ä ```spark.python.worker.memory```  —É–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—ä–µ–º–æ–º –ø–∞–º—è—Ç–∏ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –¥–ª—è **–∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞** –≤–æ—Ä–∫–µ—Ä–∞ PySpark –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ –æ–Ω **–ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è** –Ω–∞ **–¥–∏—Å–∫** —Ç–æ –µ—Å—Ç—å —ç—Ç–æ—Ç –æ–±—ä–µ–º –ø–∞–º—è—Ç–∏ **–º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–Ω—è—Ç –æ–±—ä–µ–∫—Ç–∞–º–∏ —Å–æ–∑–¥–∞–Ω–Ω—ã–º–∏ —á–µ—Ä–µ–∑ –º–æ—Å—Ç Py4J** –≤–æ –≤—Ä–µ–º—è –°–ø–∞—Ä–∫ –æ–ø–µ—Ä–∞—Ü–∏–π. –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Ç–æ –ø–æ **–¥–µ—Ñ–æ–ª—Ç—É** –±—É–¥–µ—Ç **512–ú–ë**. 

<p align="center">
<img src="/../main/Questions_for_interview/Images/pyspark_memory.png" width="80%"></p>

```spark.executor.pyspark.memory``` –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫—É—é –ø–∞–º—è—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤–æ—Ä–∫–µ—Ä–∞ Python, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—è –ø—Ä–µ–¥–µ–ª –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ø–∞–º—è—Ç–∏ –∫–æ—Ç–æ—Ä—ã–π –æ–Ω –º–æ–∂–µ—Ç –∞–¥—Ä–µ—Å–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é —Å–≤–æ–π—Å—Ç–≤–∞ ```system.RLIMIT_AS```. –ï—Å–ª–∏ –ø–∞–º—è—Ç—å worker‚Äô–∞ Python –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä ```spark.executor.pyspark.memory```, —ç—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ **–º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –≤—Å—é –ø–∞–º—è—Ç—å —É–∑–ª–∞**. –ê, –ø–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–∞ —á–∞—Å—Ç—å –ø–∞–º—è—Ç–∏ –Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è –¥–∏—Å–ø–µ—Ç—á–µ—Ä–æ–º —Ä–µ—Å—É—Ä—Å–æ–≤ –°–ø–∞—Ä–∫-–∫–ª–∞—Å—Ç–µ—Ä–∞, —Ç–∞–∫–∏–º –∫–∞–∫ Hadoop YARN, –µ—Å—Ç—å **—Ä–∏—Å–∫ –ø–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è** –≤ —É–∑–ª–µ –∏ —Å–º–µ–Ω—ã —Å—Ç—Ä–∞–Ω–∏—Ü –≤ –ø–∞–º—è—Ç–∏. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ **–∑–∞–º–µ–¥–ª–µ–Ω–∏–µ** —Ä–∞–±–æ—Ç—ã –≤—Å–µ—Ö **–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤** YARN –Ω–∞ —ç—Ç–æ–º —É–∑–ª–µ. 


## Parquet format

–ë–∏–Ω–∞—Ä–Ω—ã–π **–∫–æ–ª–æ–Ω–æ—á–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π** —Ñ–æ—Ä–º–∞—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–π –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Å–ø–∞—Ä–∫–∞, —Ç–∞–∫ –∫–∞–∫ —Å–ø–∞—Ä–∫ **–º–æ–∂–µ—Ç —Å—á–∏—Ç—ã–≤–∞—Ç—å –º–µ—Ç—É –∏ –µ–º—É –Ω–µ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å –ª–∏—à–Ω–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è**. –ü–∞—Ä–∫–µ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –æ—Å–Ω–æ–≤–∞–Ω–Ω—É—é –Ω–∞ "**—É—Ä–æ–≤–Ω—è—Ö –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è**" - –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π –≤ –ø—É—Ç–∏ –¥–ª—è **—Å—Ç–æ–ª–±—Ü–∞** –∏ "*—É—Ä–æ–≤–Ω—è—Ö –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è*" - —É–∫–∞–∑—ã–≤–∞—é—Ç –¥–ª—è –∫–∞–∫–æ–≥–æ –ø–æ–≤—Ç–æ—Ä—è–µ–º–æ–≥–æ **–ø–æ–ª—è** –≤ –ø—É—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–º–µ–µ—Ç –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ. –ü–∞—Ä–∫–µ—Ç—ã –¥–µ–ª—è—Ç—Å—è –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Ä–æ–≤–Ω–µ–π —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π: 

### Row-group 

–ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–æ–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã –Ω–∞ **—É—Ä–æ–≤–Ω–µ Map-Reduce**. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ—Ü–µ–ø—Ü–∏–∏ –ª–æ–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö, –∫–æ–≥–¥–∞ **–∫–∞–∂–¥—ã–π —É–∑–µ–ª** –∫–ª–∞—Å—Ç–µ—Ä–∞ **—Å—á–∏—Ç—ã–≤–∞–µ—Ç** –ª–∏—à—å —Ç—É *–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é*, –∫–æ—Ç–æ—Ä–∞—è —Ö—Ä–∞–Ω–∏—Ç—Å—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ **–Ω–∞ –µ–≥–æ –∂–µ—Å—Ç–∫–æ–º –¥–∏—Å–∫–µ** 

### Column chunk  

–ö–æ–ª–æ–Ω–æ—á–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –≥–¥–µ **–±–ª–æ–∫ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Å—Ç–æ–ª–±—Ü–∞** –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –≥—Ä—É–ø–ø–µ **—Å—Ç—Ä–æ–∫**. –¢–æ –µ—Å—Ç—å –≤ —Å—Ç—Ä–æ–∫–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∏–¥—Ç–∏ –ø–æ–¥—Ä—è–¥ —á—Ç–æ **–æ–±–ª–µ–≥—á–∞–µ—Ç –∏—Ö —á—Ç–µ–Ω–∏–µ** –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å csv. –ë–ª–∞–≥–æ–¥–∞—Ä—è —ç—Ç–æ–º—É –º—ã –º–æ–∂–µ–º —Å—á–∏—Ç—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –Ω–∞–º –∫–æ–ª–æ–Ω–∫–∏. –ù—É–∂–Ω–æ –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è IO –æ–ø–µ—Ä–∞—Ü–∏–π. 

### Page 

–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç –ø–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—é –∏ —Å–∂–∞—Ç–∏—é. –ö–∞–∂–¥–∞—è –∫–æ–ª–æ–Ω–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤ —Å–µ–±–µ Pages –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ 
 
### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ 

-   –ú–æ–≥—É—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –Ω–µ —Ç–æ–ª—å–∫–æ –≤ hdfs, –Ω–æ –∏ –≤ –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –∫–∞–∫ GlusterFs –∏–ª–∏ –ø–æ–≤–µ—Ä—Ö NFS 

-   –≠—Ç–æ —Ñ–∞–π–ª—ã –ø–æ—ç—Ç–æ–º—É –ª–µ–≥–∫–æ –ø–µ—Ä–µ–º–µ—â–∞—Ç—å, —Ä–µ–ø–ª–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏—Ç–¥ 

-   –ú–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –±—ã—Å—Ç—Ä—ã–π –∞–Ω–∞–ª–∏–∑ —Ç–∞–∫ –∫–∞–∫ –º–µ—Ç–∞ + –∫–æ–ª–æ–Ω—á–∞—Ç—ã–π –≤–∏–¥ 

-  –•–æ—Ä–æ—à–æ —Å–∂–∏–º–∞—é—Ç—Å—è (—Ö—É–∂–µ –û–†–° –Ω–æ –≤—ã–∏–≥—Ä—ã–≤–∞–µ—Ç –ø–æ —Å–∫–æ—Ä–æ—Å—Ç–∏) 

-   –°–∞–º–æ–µ –±—ã—Å—Ç—Ä–æ–µ —á—Ç–µ–Ω–∏–µ (–¥–∞–∂–µ  –≤—Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å –û–†–°) 

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ 

-   –ö–æ–ª–æ–Ω—á–∞—Ç—ã–π –≤–∏–¥ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –∑–∞–¥—É–º—ã–≤–∞—Ç—å—Å—è –æ —Å—Ö–µ–º–µ –∏ —Ç–∏–ø–∞—Ö –¥–∞–Ω–Ω—ã—Ö. 

-   –ö—Ä–æ–º–µ –∫–∞–∫ –≤ Spark, Parquet –Ω–µ –≤—Å–µ–≥–¥–∞ –æ–±–ª–∞–¥–∞–µ—Ç –Ω–∞—Ç–∏–≤–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≤ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–∞—Ö. 

-   –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ —ç–≤–æ–ª—é—Ü–∏—é —Å—Ö–µ–º—ã. –ö–æ–Ω–µ—á–Ω–æ, Spark —É–º–µ–µ—Ç –º–µ—Ä–¥–∂–∏—Ç—å —Å—Ö–µ–º—É, –µ—Å–ª–∏ —É –≤–∞—Å –æ–Ω–∞ –º–µ–Ω—è–µ—Ç—Å—è —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º (–¥–ª—è —ç—Ç–æ–≥–æ –Ω–∞–¥–æ —É–∫–∞–∑–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é –æ–ø—Ü–∏—é –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏), –Ω–æ, —á—Ç–æ–±—ã —á—Ç–æ-—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Ñ–∞–π–ª–µ, –Ω–µ–ª—å–∑—è –æ–±–æ–π—Ç–∏—Å—å –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏, —Ä–∞–∑–≤–µ —á—Ç–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–æ–ª–æ–Ω–∫—É. 

-   –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –æ–±—ã—á–Ω—ã–µ —Ñ–∞–π–ª—ã –∞ –Ω–µ –ë–î. 

## –ù—é–∞–Ω—Å—ã –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ JSON

JSON - —ç—Ç–æ **–Ω–µ splittable** —Ñ–∞–π–ª, —Ç–æ –µ—Å—Ç—å —Å–ø–∞—Ä–∫ –Ω–µ –º–æ–∂–µ—Ç —Ä–∞–∑–¥–µ–ª–∏—Ç—å –µ–≥–æ –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Ç–æ–∫–∞–º–∏. –ü–æ—ç—Ç–æ–º—É –µ—Å–ª–∏ –Ω–∞–º –ø—Ä–∏–ª–µ—Ç–∏—Ç –¥–∂–µ–π—Å–æ–Ω–∏–Ω–∞ —Ä–∞–∑–º–µ—Ä–æ–º 1–ì–ë —Ç–æ –¥–ª—è —Å–ø–∞—Ä–∫–∞ —ç—Ç–æ –±—É–¥–µ—Ç –æ–¥–Ω–∞ –ø–∞—Ä—Ç–∏—Ü–∏—è —á—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ **spill-—ç—Ñ—Ñ–µ–∫—Ç—É** (–º—ã –∑–Ω–∞–µ–º —á—Ç–æ —Å–ø–∞—Ä–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –æ–ø–µ—Ä–∞—Ç–∏–≤–∫–æ–π, –Ω–æ –ø—Ä–∏ spill —ç—Ñ—Ñ–µ–∫—Ç–µ –æ–Ω –ø–µ—Ä–µ–ª–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ –¥–∏—Å–∫. Spill = –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ RDD –∏–∑ –æ–ø–µ—Ä–∞—Ç–∏–≤–∫–∏ –Ω–∞ –¥–∏—Å–∫ –∏ –æ–±—Ä–∞—Ç–Ω–æ. –ß—Ç–æ –µ—â–µ —Ö—É–∂–µ, —Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å OOM. –í–æ–æ–±—â–µ –µ—Å—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞(—Ç–æ–∫ –Ω–µ –ø–æ–º–Ω—é –æ—Ç –∫–æ–≥–æ) —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –¥–ª—è JSON, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è splittable, –Ω–æ –¥—É–º–∞—é –≤—ã –µ–≥–æ –Ω–µ –≤—Å—Ç—Ä–µ—Ç–∏—Ç–µ. 

## –ù—é–∞–Ω—Å—ã –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ CSV

CSV —Ö—Ä–∞–Ω–∏—Ç —Ñ–∞–π–ª—ã –≤ **—Å—Ç—Ä–æ–∫–∞—Ö**, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —á—Ç–æ –ø—Ä–∏ **–ø—Ä–æ—á—Ç–µ–Ω–∏–∏** —Ñ–∞–π–ª–∞ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø—Ä–æ—á–µ—Å—Ç—å **–≤—Å–µ —Å—Ç—Ä–æ–∫–∏**. –î–∞ –æ–Ω **–±—É–¥–µ—Ç —É–¥–∞–ª—è—Ç—å –Ω–µ–Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** –ø–æ—Ç–æ–º, –Ω–æ –≤—Å–µ —Ä–∞–≤–Ω–æ –∏–¥–µ—Ç **–±–æ–ª—å—à–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –¥–∏—Å–∫** —Ç–∞–∫ –∫–∞–∫ –µ–º—É –Ω—É–∂–Ω–æ —Å—á–∏—Ç–∞—Ç—å –≤—Å–µ. –í —Å–ø–∞—Ä–∫–µ –µ—Å—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä—ã **predicate pushdown (—Å—Ç—Ä–æ–∫–∏)** / **projection pushdown (–∫–æ–ª–æ–Ω–∫–∏)** –∫–æ—Ç–æ—Ä—ã–µ –≤–æ –≤—Ä–µ–º—è —á—Ç–µ–Ω–∏—è —Å—Ç—Ä–æ–∫ –≤ CSV —Å—Ä–∞–∑—É –ø—Ä–∏–º–µ–Ω—è—é—Ç —Ñ–∏–ª—å—Ç—Ä. –¢–æ –µ—Å—Ç—å —Å–ø–∞—Ä–∫ —á–∏—Ç–∞–µ—Ç —Å—Ç—Ä–æ–∫—É –∏ –µ—Å–ª–∏ –æ–Ω–∞ –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –ø–æ–¥ —Ñ–∏–ª—å—Ç—Ä - —É–¥–∞–ª—è–µ—Ç (–º–æ–∂–Ω–æ –Ω–µ —É–¥–∞–ª—è—Ç—å –ø—Ä–æ–∫–∏–Ω—É–≤ –ø–µ—Ä–∑–∏—Å—Ç –∏ –∫–µ—à–µ–¥). –ö—Ä–æ–º–µ —Ç–æ–≥–æ CSV **–Ω–µ —Ö—Ä–∞–Ω–∏—Ç –º–µ—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é** (–∫–∞–∫ –ø–∞—Ä–∫–µ—Ç –Ω–∞–ø—Ä–∏–º–µ—Ä) –ø–æ—ç—Ç–æ–º—É —Å–ø–∞—Ä–∫—É –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —Å–∞–º–æ–º—É –≤—Å–µ —Å—á–∏—Ç–∞—Ç—å –∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å. –ö–∞–∫ —è –ø–æ–Ω—è–ª —ç—Ç–æ **–Ω–∞–≥—Ä—É–∂–∞–µ—Ç –¥—Ä–∞–π–≤–µ—Ä** –ø–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–∏ –ø–∞—Ä–∫–µ—Ç–µ –æ–Ω –ø–æ–ª—É—á–∞–µ—Ç –º–µ—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –µ–º—É –ª–µ–≥—á–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã. 

## Broadcast variables

–ö–æ–≥–¥–∞ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞–∫—É—é —Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –ø—Ä–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Ç–æ —ç—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –≤–º–µ—Å—Ç–µ —Å –∑–∞–¥–∞—á–µ–π. –ú—ã –ø–æ–º–Ω–∏–º —á—Ç–æ **–æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞ - –æ–¥–Ω–∞ –ø–∞—Ä—Ç–∏—Ü–∏—è** –∏ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å 500 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ 500 –ø–∞—Ä—Ç–∏—Ü–∏–π. –ó–≤—É—á–∏—Ç —Ç–∞–∫ —Å–µ–±–µ –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ —É—á–∏—Ç—ã–≤–∞—Ç—å —á—Ç–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –º–æ–≥—É—Ç –±—ã—Ç—å –æ–≥—Ä–æ–º–Ω—ã–µ –º–∞—Å—Å–∏–≤—ã. –î–ª—è —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –∑–∞–∫–∏–Ω—É—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≤ –±—Ä–æ–∞–¥–∫–∞—Å—Ç = –ø–æ—Å–ª–∞—Ç—å –µ–µ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ä–∞–∑–¥–µ–ª –ø–∞–º—è—Ç–∏ –≥–¥–µ –æ–Ω–∞ –±—É–¥–µ—Ç —Ç—Ä–∞–Ω—Å–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤—Å–µ–º –ø–∞—Ä—Ç–∏—Ü–∏—è–º (–Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –±—Ä–æ–∞–¥–∫–∞—Å—Ç –¥–∂–æ–π–Ω–∞ –¥–∞?) 